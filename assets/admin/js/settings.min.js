!function(e){"use strict";const t=window.flexify_checkout_params||{};"yes"===t.debug_mode&&(console.log("[FLEXIFY CHECKOUT VERSION]: ",t.plugin_version),console.log("[FLEXIFY CHECKOUT] Admin params: ",t));var i={keepButtonState:function(e){var t=e.width(),i=e.height(),n=e.html();return e.width(t),e.height(i),{width:t,height:i,html:n}},displayToast:function(i,n,o,s=""){let a="";a="success"===i?'<svg class="icon icon-white me-2" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" style="fill: rgba(255, 255, 255, 1);"><path d="M12 2C6.486 2 2 6.486 2 12s4.486 10 10 10 10-4.486 10-10S17.514 2 12 2zm0 18c-4.411 0-8-3.589-8-8s3.589-8 8-8 8 3.589 8 8-3.589 8-8 8z"></path><path d="M9.999 13.587 7.7 11.292l-1.412 1.416 3.713 3.705 6.706-6.706-1.414-1.414z"></path></svg>':'<svg class="icon icon-white me-2" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" style="fill: rgba(255, 255, 255, 1);transform: ;msFilter:;"><path d="M12 2C6.486 2 2 6.486 2 12s4.486 10 10 10 10-4.486 10-10S17.514 2 12 2zm0 18c-4.411 0-8-3.589-8-8s3.589-8 8-8 8 3.589 8 8-3.589 8-8 8z"></path><path d="M11 11h2v6h-2zm0-4h2v2h-2z"></path></svg>',"error"===i&&(i="danger");const c=`<div class="toast toast-${i} ${s} show">\n                <div class="toast-header bg-${i} text-white">\n\t\t\t\t\t${a}\n\t\t\t\t\t<span class="me-auto">${n||""}</span>\n                    <button class="btn-close btn-close-white ms-2" type="button" aria-label="${t.close_aria_label_notice||"Close"}"></button>\n                </div>\n                <div class="toast-body">${o||""}</div>\n            </div>`;e(".flexify-checkout-wrapper").before(c),e(document).on("click",".toast .btn-close",(function(){e(".toast.show").fadeOut("fast")})),setTimeout((function(){e(`.toast-${i}`).fadeOut("fast",(function(){e(this).remove()}))}),3e3)},initTabs:function(){e((function(){let t=window.location.hash,i=localStorage.getItem("flexify_checkout_get_admin_tab_index");if(t){let i=e(`.flexify-checkout-wrapper a.nav-tab[href="${t}"]`);i.length&&i.click()}else null!==i?e(".flexify-checkout-wrapper a.nav-tab").eq(i).click():e('.flexify-checkout-wrapper a.nav-tab[href="#general"]').click()})),e(document).on("click",".flexify-checkout-wrapper a.nav-tab",(function(){let t=e(this).index();localStorage.setItem("flexify_checkout_get_admin_tab_index",t);let i=e(this).attr("href");return e(".flexify-checkout-wrapper a.nav-tab").removeClass("nav-tab-active"),e(".flexify-checkout-form .nav-content").removeClass("active"),e(this).addClass("nav-tab-active"),e(".flexify-checkout-form").find(i).addClass("active"),!1}))},saveOptions:function(){let n=e('form[name="flexify-checkout"]'),o=n.serialize();n.on("change input","input, select, textarea",(()=>{e("#flexify_checkout_save_options").prop("disabled",n.serialize()===o)})),e(document).on("click","#flexify_checkout_save_options",(s=>{s.preventDefault();let a=e(s.currentTarget),c=this.keepButtonState(a);e.ajax({url:t.ajax_url,type:"POST",data:{action:"flexify_checkout_save_settings",form_data:n.serialize()},beforeSend:function(){a.prop("disabled",!0).html('<span class="spinner-border spinner-border-sm"></span>')},success:e=>{try{"success"===e.status?(o=n.serialize(),i.displayToast("success",e.toast_header_title,e.toast_body_title)):i.displayToast("danger",e.toast_header_title,e.toast_body_title)}catch(e){console.log(e)}},error:function(e,t,i){console.error("AJAX request failed:",t,i)},complete:function(){a.html(c.html)}})}))},setupVisibilityControllers:function(){const t=(t,i,n=null)=>{const o=e(t),s=()=>{const t=o.val();if(o.is(":checkbox")){const t=o.is(":checked");"string"==typeof i&&e(i).toggleClass("d-none",!t)}else if("object"!=typeof i||Array.isArray(i)){if(Array.isArray(i)&&n){const o=i.includes(t);e(n).toggleClass("d-none",!o)}else if("string"==typeof i){const n="no"!==t&&"false"!==t&&""!==t;e(i).toggleClass("d-none",!n)}}else e.each(i,(function(i,n){e(n).toggleClass("d-none",t!==i)}))};e(document).off("change",t).on("change",t,s),s()};t("#enable_auto_apply_coupon_code",".show-coupon-code-enabled"),t("#enable_inter_bank_pix_api",".inter-bank-pix"),t("#enable_inter_bank_ticket_api",".inter-bank-slip"),t("#enable_fill_address",".require-auto-fill-address"),t("#enable_manage_fields",".step-checkout-fields-container"),t("#enable_field_masks",".require-input-mask"),t("#email_providers_suggestion",".require-email-suggestions-enabled"),t("#enable_inter_bank_pix_api",".require-enabled-inter-pix"),t("#enable_inter_bank_ticket_api",".require-enabled-inter-slip-bank"),t("#enable_animation_process_purchase",".require-process-animations-enabled"),t("#add_new_condition_component",{field:".specific-component-fields",payment:".specific-component-payment",shipping:".specific-component-shipping"}),t("#add_new_condition_user_function",{specific_user:".specific-users-container",specific_role:".specific-roles-container"}),t("#add_new_condition_product_filter",{specific_products:".specific-products",specific_categories:".specific-categories",specific_attributes:".specific-attributes"}),t("#add_new_condition_component_verification",{field:".specific-checkout-fields"}),t("#checkout_header_type",{logo:".header-styles-option-logo",text:".header-styles-option-text"}),t("#add_new_condition_component_type",["is","is_not","contains","not_contain","start_with","finish_with","bigger_then","less_than"],".condition-value"),t("#contact_page_thankyou",{custom_link:".require-custom-link-enabled"}),t("#enable_checkout_countdown",".require-countdown-enabled"),t("#checkout_countdown_action",{logout:".require-countdown-action-logout"}),t("#countdown_background_type",{custom:".require-custom-background-color"}),t("#countdown_font_color_type",{custom:".require-custom-font-color"})},enforceMinOne:function(){e(document).on("input",".allow-numbers-be-1",(function(){let t=parseFloat(e(this).val());(isNaN(t)||t<1)&&e(this).val(1)}))},filterDesignParameters:function(){e(document).on("keydown",".design-parameters",(function(e){let t=e.charCode||e.keyCode||0;return t>=96&&t<=105||t>=48&&t<=57||190===t||189===t||109===t||8===t}))},mediaSelectors:function(){const i=(t,i,n,o,s=!1)=>{let a;e(document).on("click",t,(function(t){t.preventDefault(),a||(a=wp.media.frames.file_frame=wp.media({title:n,button:{text:o},multiple:s}),a.on("select",(function(){const t=a.state().get("selection").first().toJSON();e(i).val(t.url).trigger("change")}))),a.open()}))};i("#flexify-checkout-search-header-logo",'input[name="search_image_header_checkout"]',t.set_logo_modal_title,t.use_this_image_title),i("#animation_process_purchase_file_1_trigger",'input[name="animation_process_purchase_file_1"]',t.set_animation_modal_title,t.set_animation_button_title),i("#animation_process_purchase_file_2_trigger",'input[name="animation_process_purchase_file_2"]',t.set_animation_modal_title,t.set_animation_button_title),i("#animation_process_purchase_file_3_trigger",'input[name="animation_process_purchase_file_3"]',t.set_animation_modal_title,t.set_animation_button_title)},displayModal:function(t,i,n){e(document).on("click",t,(function(t){t.preventDefault(),e(i).addClass("show")})),e(document).on("click",i,(function(t){t.target===this&&e(this).removeClass("show")})),e(document).on("click",n,(function(t){t.preventDefault(),e(i).removeClass("show")}))},popups:function(){this.displayModal("#inter_bank_credencials_settings","#inter_bank_credendials_container","#inter_bank_credendials_close"),this.displayModal("#inter_bank_pix_settings","#inter_bank_pix_container","#inter_bank_pix_close"),this.displayModal("#inter_bank_slip_settings","#inter_bank_slip_container","#inter_bank_slip_close"),this.displayModal("#require_inter_bank_module_trigger","#require_inter_bank_module_container","#require_inter_bank_module_close"),this.displayModal(".require-pro","#popup-pro-notice",".require-pro-close"),this.displayModal("#set_ip_api_service_trigger",".set-api-service-container",".set-api-service-close"),this.displayModal("#add_new_checkout_fields_trigger",".add-new-checkout-fields-container",".add-new-checkout-fields-close"),this.displayModal("#auto_fill_address_api_trigger",".auto-fill-address-api-container",".auto-fill-address-api-close"),this.displayModal("#set_new_font_family_trigger","#set_new_font_family_container","#close_new_font_family"),this.displayModal("#fcw_reset_settings_trigger","#fcw_reset_settings_container","#fcw_close_reset"),this.displayModal("#add_new_checkout_condition_trigger","#add_new_checkout_condition_container","#close_add_new_checkout_condition"),this.displayModal("#set_email_providers_trigger","#set_email_providers_container","#close_set_email_providers"),this.displayModal("#set_process_purchase_animation_trigger","#set_process_purchase_animation_container","#close_set_process_purchase_animation"),this.displayModal("#set_countdown_trigger","#set_countdown_container","#close_set_countdown")},colorHelpers:function(){e(document).on("input",".get-color-selected",(function(){let t=e(this).val();e(this).closest(".color-container").find(".form-control-color").val(t)})),e(document).on("input",".form-control-color",(function(){let t=e(this).val();e(this).closest(".color-container").find(".get-color-selected").val(t)})),e(document).on("click",".reset-color",(function(t){t.preventDefault();let i=e(this).data("color");const n=e(this).closest(".color-container");n.find(".form-control-color").val(i),n.find(".get-color-selected").val(i).trigger("change")}))},datepicker:function(){const t=t=>{e(t).datepicker({format:"dd/mm/yyyy",todayHighlight:!0,language:"pt-BR"})};e(".dateselect").each((function(){t(this)})),e(document).on("focus",".dateselect",(function(){e(this).data("datepicker")||t(this)}))},fieldsManager:function(){var i=e("#flexify_checkout_step_1").sortable({connectWith:"#flexify_checkout_step_2",update:(e,t)=>{o(e,t,"1")}}),n=e("#flexify_checkout_step_2").sortable({connectWith:"#flexify_checkout_step_1",update:(e,t)=>{o(e,t,"2")}});function o(t,i,n){var o=i.item.closest(".step-container");e(o).find(".field-item").each((function(t){e(this).find(".change-priority").val(t+1).trigger("change")})),e(i.item).parent().siblings(".step-title").each((function(){e(this).closest(".step-container").find(".field-item").find(".change-step").val(n).trigger("change")}))}function s(t){var i=e("#"+t),n=i.find(".field-item");n.sort((function(t,i){return parseInt(e(t).find(".change-priority").val()||0,10)-parseInt(e(i).find(".change-priority").val()||0,10)})),n.detach().appendTo(i)}s("flexify_checkout_step_1"),s("flexify_checkout_step_2"),e(document).on("click",".flexify-checkout-step-trigger",(function(t){t.preventDefault(),e(t.target).closest(".field-item").addClass("active").children(".flexify-checkout-step-container").addClass("show"),e(i).sortable("option","disabled",!0),e(n).sortable("option","disabled",!0)})),e(document).on("click",".flexify-checkout-step-close-popup",(function(t){t.preventDefault(),e(this).closest(".flexify-checkout-step-container").removeClass("show"),e(".flexify-checkout-step-trigger").closest(".field-item").removeClass("active"),e(i).sortable("option","disabled",!1),e(n).sortable("option","disabled",!1)})),e(document).on("click",".flexify-checkout-step-container",(function(t){t.target===this&&(e(this).removeClass("show"),e(".flexify-checkout-step-trigger").closest(".field-item").removeClass("active"),e(i).sortable("option","disabled",!1),e(n).sortable("option","disabled",!1))})),e(document).on("click",".toggle-active-field",(function(t){let i=e(t.target).prop("checked"),n=e(".field-item.active");n.toggleClass("active",i).removeClass("inactive"),n.toggleClass("inactive",!i).removeClass("active")})),e(".field-item").hasClass("require-pro")&&(e(i).sortable("option","disabled",!0),e(n).sortable("option","disabled",!0)),e(document).on("click",".exclude-field",(i=>{if(i.preventDefault(),confirm(t.confirm_exclude_field)){var n=e(i.currentTarget),o=this.keepButtonState(n),s=n.data("exclude");n.html('<span class="spinner-border spinner-border-sm"></span>'),e.ajax({url:t.ajax_url,type:"POST",data:{action:"remove_checkout_fields",field_to_remove:s},success:t=>{try{t&&"success"===t.status?(e("#"+t.field).fadeOut(500,(function(){e(this).remove()})),this.displayToast("success",t.toast_header_title,t.toast_body_title)):(this.displayToast("danger",t.toast_header_title,t.toast_body_title),console.error('Invalid JSON response or missing "status" field:',t))}catch(e){console.error("Error parsing JSON:",e)}},error:function(e,t,i){console.error("AJAX request failed:",t,i)},complete:()=>{n.html(o.html).width(o.width).height(o.height)}})}})),e(document).on("blur","#checkout_field_name",(function(){var i=`billing_${e(this).val()}`;""!==e(this).val()&&(e("#checkout_field_name").before('<span id="check_field_id" class="spinner-border spinner-border-sm" style="position:absolute;padding:0.3rem;border-radius:100%!important;right:1rem;z-index:2;top:0.7rem;"></span>'),e.ajax({url:t.ajax_url,type:"POST",data:{action:"check_field_availability",field_name:i},success:function(t){try{"success"===t.status&&(e("#check_field_id").remove(),!0===t.available?(e("#check_field_availability").addClass("d-none"),e("#set_field_id").removeClass("invalid-option"),e("#checkout_field_name_concat").val(i)):(e("#check_field_availability").removeClass("d-none"),e("#set_field_id").addClass("invalid-option"),e("#checkout_field_name_concat").val("")))}catch(e){console.error("Error parsing JSON:",e)}},error:function(e,t,i){console.error("AJAX request failed:",t,i)}}))})),e(document).on("change","#checkout_field_type",(function(){let t=e(this).val();"select"===t?(e(".require-add-new-field-select").removeClass("d-none"),e(".require-add-new-field-multicheckbox").addClass("d-none")):"multicheckbox"===t?(e(".require-add-new-field-multicheckbox").removeClass("d-none"),e(".require-add-new-field-select").addClass("d-none")):e(".require-add-new-field-select, .require-add-new-field-multicheckbox").addClass("d-none")})),e(document).on("click","#add_new_options_to_select",(function(t){t.preventDefault();let i=e("#add_new_field_select_option_value"),n=e("#add_new_field_select_option_title"),o=`<div class="d-flex align-items-center mb-3 option-container" data-option="${i.val()}">\n                    <div class="input-group me-3">\n                        <span class="input-group-text d-flex align-items-center justify-content-center w-25">${i.val()}</span>\n                        <span class="input-group-text d-flex align-items-center justify-content-center w-75">${n.val()}</span>\n                    </div>\n                    <button class="btn btn-outline-danger btn-icon rounded-3 exclude-option-select" data-exclude="${i.val()}">\n                        <svg class="icon icon-danger" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M15 2H9c-1.103 0-2 .897-2 2v2H3v2h2v12c0 1.103.897 2 2 2h10c1.103 0 2-.897 2-2V8h2V6h-4V4c0-1.103-.897-2-2-2zM9 4h6v2H9V4zm8 16H7V8h10v12z"></path></svg>\n                    </button>\n                </div>`;e("#preview_options_container").append(o),e("#preview_select_new_field").append(new Option(n.val(),i.val())),i.val(""),n.val("")})),e(document).on("click",".exclude-option-select",(function(t){t.preventDefault();let i=e(this).data("exclude");e(this).closest(".option-container").remove(),e(`#preview_select_new_field > option[value="${i}"]`).remove()})),e(document).on("click","#add_new_options_to_multicheckbox",(function(t){t.preventDefault();let i=e("#add_new_field_multicheckbox_option_id"),n=e("#add_new_field_multicheckbox_option_title"),o=`<div class="form-check mb-2 multicheckbox-container">\n                    <input class="form-check-input" type="checkbox" id="${i.val()}">\n                    <label class="form-check-label" for="${i.val()}">${n.val()}</label>\n                    <button class="btn btn-outline-danger btn-icon rounded-3 ms-3 exclude-option-multicheckbox" data-exclude="${i.val()}">\n                        <svg class="icon icon-danger" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M15 2H9c-1.103 0-2 .897-2 2v2H3v2h2v12c0 1.103.897 2 2 2h10c1.103 0 2-.897 2-2V8h2V6h-4V4c0-1.103-.897-2-2-2zM9 4h6v2H9V4zm8 16H7V8h10v12z"></path></svg>\n                    </button>\n                </div>`;e("#preview_multicheckbox_container").append(o),i.val(""),n.val("")})),e(document).on("click",".exclude-option-multicheckbox",(function(t){t.preventDefault(),e(this).closest(".multicheckbox-container").remove()})),e(document).on("change","#required_field",(function(){e(this).val(e(this).is(":checked")?"yes":"no")})),e(document).on("keyup input",".get-name-field",(function(){let t=e(this).val(),i=e(this).closest(".flexify-checkout-step-container.show");i.find("h5.popup-title .field-name").text(t),i.parent(".field-item").children(".field-name").text(t)})),e(document).on("click","#fcw_add_new_field",(i=>{i.preventDefault();var n=e(i.currentTarget),o=n.text(),s=this.keepButtonState(n);n.html('<span class="spinner-border spinner-border-sm"></span>');var a=e("#checkout_field_name_concat").val(),c=e("#checkout_field_type").val(),l=e("#checkout_field_title").val(),r=e("#required_field").val(),d=e("#field_position").val(),_=e("#field_classes").val(),p=e("#field_label_classes").val(),u=e("#field_step").val(),f=e("#field_source").val(),h=e("#field_input_mask").val(),m=(t.get_array_checkout_fields?t.get_array_checkout_fields.length:0)+1,v=[];"select"===c&&e("#preview_select_new_field option").each((function(){v.push({value:e(this).val(),text:e(this).text()})})),e.ajax({url:t.ajax_url,type:"POST",data:{action:"add_new_field_to_checkout",get_field_id:a,get_field_type:c,get_field_label:l,get_field_required:r,get_field_position:d,get_field_classes:_,get_field_label_classes:p,get_field_step:u,get_field_source:f,get_field_priority:m,get_field_options_for_select:v,input_mask:h},success:t=>{try{if("success"===t.status){e("#fcw_add_new_field").text(o);var i=e("#"+a);i.length?i.replaceWith(t.field_html):"1"===u?e("#flexify_checkout_step_1").append(t.field_html):"2"===u&&e("#flexify_checkout_step_2").append(t.field_html),this.displayToast("success",t.toast_header_title,t.toast_body_title),e(".add-new-checkout-fields-container").removeClass("show"),e("#checkout_field_name").val(""),e("#checkout_field_name_concat").val(""),e("#checkout_field_type").val("text"),e("#checkout_field_title").val(""),e("#required_field").val("no").prop("checked",!1),e("#field_position").val("left"),e("#field_classes").val(""),e("#field_label_classes").val(""),e("#field_step").val("1"),e("#field_source").val(""),e("#field_input_mask").val(""),e(".require-add-new-field-select").addClass("d-none"),e("#preview_select_new_field > option").remove(),e("#preview_options_container").html("")}else this.displayToast("danger",t.toast_header_title,t.toast_body_title),console.error('Invalid JSON response or missing "status" field:',t)}catch(e){console.error("Error parsing JSON:",e)}},error:function(e,t,i){console.error("AJAX request failed:",t,i)},complete:()=>{n.html(s.html).width(s.width).height(s.height)}})})),e(document).on("click",".exclude-option-select-live",(i=>{if(i.preventDefault(),!confirm(t.confirm_remove_option))return;let n=e(i.currentTarget),o=this.keepButtonState(n),s=n.data("field-id"),a=n.data("option");n.html('<span class="spinner-border spinner-border-sm"></span>'),e.ajax({url:t.ajax_url,type:"POST",data:{action:"remove_select_option",field_id:s,exclude_option:a},success:e=>{try{"success"===e.status?(n.closest(".option-container-live").remove(),this.displayToast("success",e.toast_header_title,e.toast_body_title)):(this.displayToast("danger",e.toast_header_title,e.toast_body_title),console.error('Invalid JSON response or missing "status" field:',e))}catch(e){console.error("Error parsing JSON:",e)}},error:function(e,t,i){console.error("AJAX request failed:",t,i)},complete:()=>{n.html(o.html).width(o.width).height(o.height)}})})),e(document).on("click","#add_new_select_option_live",(function(i){i.preventDefault();const n=`<div id="new_select_option_live_preview" class="d-flex align-items-center justify-content-between mb-4">\n                    <div class="d-grid me-3">\n                        <div class="input-group mb-3">\n                            <span class="input-group-text w-fit">${t.new_option_value}</span>\n                            <input type="text" id="add_new_field_select_option_value_live" class="form-control input-control-wd-12" value="" placeholder="${t.placeholder_new_option_value}">\n                        </div>\n                        <div class="input-group">\n                            <span class="input-group-text w-fit">${t.new_option_title}</span>\n                            <input type="text" id="add_new_field_select_option_title_live" class="form-control input-control-wd-12" value="" placeholder="${t.placeholder_new_option_title}">\n                        </div>\n                    </div>\n                    <button id="add_new_options_to_select_live" class="btn btn-icon btn-icon-lg btn-outline-secondary">\n                        <svg class="icon icon-dark" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 11h-6V5h-2v6H5v2h6v6h2v-6h6z"></path></svg>\n                    </button>\n                </div>`;e(this).prop("disabled",!0).before(n)})),e(document).on("click","#add_new_options_to_select_live",(i=>{i.preventDefault();let n=e(i.currentTarget),o=this.keepButtonState(n),s=e(".field-item.active").attr("id"),a=e("#add_new_field_select_option_value_live").val(),c=e("#add_new_field_select_option_title_live").val();const l=`<div class="d-flex align-items-center mb-3 option-container-live" data-option="${a}">\n                    <div class="input-group me-3">\n                        <span class="input-group-text d-flex align-items-center justify-content-center py-2 w-25">${a}</span>\n                        <span class="input-group-text d-flex align-items-center justify-content-center w-75">${c}</span>\n                    </div>\n                    <button class="btn btn-outline-danger btn-icon rounded-3 exclude-option-select-live" data-field-id="${s}" data-option="${a}">\n                        <svg class="icon icon-danger" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M15 2H9c-1.103 0-2 .897-2 2v2H3v2h2v12c0 1.103.897 2 2 2h10c1.103 0 2-.897 2-2V8h2V6h-4V4c0-1.103-.897-2-2-2zM9 4h6v2H9V4zm8 16H7V8h10v12z"></path></svg>\n                    </button>\n                </div>`;n.html('<span class="spinner-border spinner-border-sm"></span>'),e.ajax({url:t.ajax_url,type:"POST",data:{action:"add_new_option_select_live",field_id:s,option_value:a,option_title:c},success:t=>{try{"success"===t.status?(e("#add_new_select_option_live").prop("disabled",!1),e("#new_select_option_live_preview").remove(),e(".field-item.active .options-container-live").append(l),this.displayToast("success",t.toast_header_title,t.toast_body_title)):(this.displayToast("danger",t.toast_header_title,t.toast_body_title),console.error('Invalid JSON response or missing "status" field:',t))}catch(e){console.error("Error parsing JSON:",e)}},error:function(e,t,i){console.error("AJAX request failed:",t,i)},complete:()=>{n.html(o.html).width(o.width).height(o.height)}})}))},resetSettings:function(){e(document).on("click","#confirm_reset_settings",(function(t){t.preventDefault();let n=e(this),o=i.keepButtonState(n);e.ajax({url:flexify_checkout_params.ajax_url,type:"POST",data:{action:"flexify_checkout_reset_plugin_action"},beforeSend:function(){n.html('<span class="spinner-border spinner-border-sm"></span>')},success:function(t){try{"success"===t.status?(n.html(o.html),e("#fcw_close_reset").click(),i.displayToast("success",t.toast_header_title,t.toast_body_title),setTimeout((function(){location.reload()}),1e3)):i.displayToast("error",t.toast_header_title,t.toast_body_title)}catch(e){console.log(e)}}})}))},themeSelector:function(){e(document).on("click",".card-theme-item",(function(t){let i=e(this),n=i.data("theme");i.hasClass("coming-soon")||(e(".card-theme-item").removeClass("active"),i.addClass("active"),e('input[name="flexify_checkout_theme"]').val(n).change())}))},handleConditions:function(){const t=(e,t=250)=>{let i;return function(...n){clearTimeout(i),i=setTimeout((()=>e.apply(this,n)),t)}},n=t=>e(t).val()||"none",o=()=>{const t=n(c.type_rule),i=n(c.component),o=n(c.component_field),s=n(c.payment),a=n(c.shipping),l=n(c.verification_condition),r=n(c.verification_condition_field),d=n(c.condition),_=e(c.condition_value).val()||"";let p="none"!==t&&"none"!==i&&"none"!==d;"field"===i&&"none"===o&&(p=!1),"payment"===i&&"none"===s&&(p=!1),"shipping"===i&&"none"===a&&(p=!1),"field"===l&&"none"===r&&(p=!1),["is","is_not","contains","not_contain","start_with","finish_with","bigger_then","less_than"].includes(d)&&""===_.trim()&&(p=!1),e(c.submit).prop("disabled",!p)},s=t=>{const i=e(t);i.find("select").each((function(){const t=e(this).find("option:first").val();e(this).val(t).trigger("change")})),i.find('input[type="text"], input[type="search"], input[type="number"]').val(""),e(c.products_box).empty().removeClass("has-items"),e(c.categories_box).empty().removeClass("has-items"),e(c.attributes_box).empty().removeClass("has-items"),e(c.users_box).empty().removeClass("has-items"),l.clear(),r.clear(),d.clear(),_.clear(),o()},a=(i,n,o,s,a)=>{const c=t((function(t){const s=e(t.target).val().trim(),a=e(n);s.length<3?a.empty().removeClass("has-items"):(a.next(".specific-search-spinner").length||e(t.target).after('<i class="spinner-border specific-search-spinner"></i>'),e.ajax({url:flexify_checkout_params.ajax_url,type:"POST",dataType:"html",data:{action:o,search_query:s}}).done((t=>{e(i).parent("div").find(".specific-search-spinner").remove(),a.html(t).addClass("has-items")})).fail(((t,n,o)=>{console.error("AJAX search failed:",n,o),e(i).parent("div").find(".specific-search-spinner").remove()})))}),300);e(document).off("keyup",i).on("keyup",i,c),e(document).off("click",`${n} li.list-group-item`).on("click",`${n} li.list-group-item`,(function(){const t=e(this).data(s);(t||0===t)&&(e(this).toggleClass("selected").hasClass("selected")?a.add(t):a.delete(t))}))},c={container:"#add_new_condition_container_master",submit:"#add_new_condition_submit",type_rule:"#add_new_condition_type_rule",component:"#add_new_condition_component",component_field:"#add_new_condition_specific_field_component",verification_condition:"#add_new_condition_component_verification",verification_condition_field:"#add_new_condition_specific_field",condition:"#add_new_condition_component_type",condition_value:"#add_new_condition_get_condition_value",payment:"#add_new_condition_specific_payment_component",shipping:"#add_new_condition_specific_shipping_component",user_function:"#add_new_condition_user_function",user_role:"#add_new_condition_specific_user_role",product_filter:"#add_new_condition_product_filter",product_input:".product-search",category_input:".category-search",attribute_input:".attribute-search",user_input:".user-search",products_box:"#get_specific_products",categories_box:"#get_specific_categories",attributes_box:"#get_specific_attribute",users_box:"#get_specific_users",close_modal_btn:"#close_add_new_checkout_condition"},l=new Set,r=new Set,d=new Set,_=new Set;e(document).off("change keyup",`${c.container} select, ${c.container} input`).on("change keyup",`${c.container} select, ${c.container} input`,o),e(document).off("change",c.product_filter).on("change",c.product_filter,o);const p=e(c.condition).find("option").clone();e(document).on("change",c.verification_condition_field,(function(){const t=e(this).find("option:selected").data("type"),i=e(c.condition);i.html(p.clone()),"checkbox"===t&&i.find("option").each((function(){const t=e(this).val();["none","checked","not_checked"].includes(t)||e(this).remove()})),i.val("none").trigger("change")})),e(document).on("change",c.verification_condition,(function(){"field"!==e(this).val()?e(c.condition).html(p.clone()).val("none").trigger("change"):e(c.verification_condition_field).trigger("change")})),a(c.product_input,c.products_box,"get_woo_products_ajax","product-id",l),a(c.category_input,c.categories_box,"get_woo_categories_ajax","category-id",r),a(c.attribute_input,c.attributes_box,"get_woo_attributes_ajax","attribute-id",d),a(c.user_input,c.users_box,"search_users_ajax","user-id",_),e(document).off("click",c.submit).on("click",c.submit,(t=>{t.preventDefault();const o=e(t.currentTarget),a=i.keepButtonState(o);o.html('<span class="spinner-border spinner-border-sm"></span>');const p=(()=>{const t=new FormData;t.set("action","add_new_checkout_condition"),t.set("type_rule",n(c.type_rule)),t.set("component",n(c.component)),t.set("component_field",n(c.component_field)),t.set("verification_condition",n(c.verification_condition)),t.set("verification_condition_field",n(c.verification_condition_field));const i=n(c.condition);t.set("condition",i),["checked","not_checked"].includes(i)?t.set("condition_value",""):t.set("condition_value",e(c.condition_value).val()||""),t.set("payment_method",n(c.payment)),t.set("shipping_method",n(c.shipping));const o=n(c.user_function);t.set("filter_user",n(c.user_role)),"specific_user"===o?t.set("specific_user",JSON.stringify([..._])):"specific_role"===o&&t.set("specific_role",n(c.user_role));const s=n(c.product_filter);return t.set("product_filter",s),"specific_products"===s&&t.set("specific_products",JSON.stringify([...l])),"specific_categories"===s&&t.set("specific_categories",JSON.stringify([...r])),"specific_attributes"===s&&t.set("specific_attributes",JSON.stringify([...d])),t})();e.ajax({url:flexify_checkout_params.ajax_url,type:"POST",data:p,processData:!1,contentType:!1,dataType:"json"}).done((t=>{if(t&&"success"===t.status){i.displayToast("success",t.toast_header_title,t.toast_body_title);const n=e("#display_conditions"),o=`<li class="list-group-item d-flex align-items-center justify-content-between">\n                            <div class="d-grid">\n                                <div class="mb-2">${t.condition_line_1||""}</div>\n                                <div>${t.condition_line_2||""}</div>\n                            </div>\n                            <button class="exclude-condition btn btn-icon btn-sm btn-outline-danger rounded-3 ms-3">\n                                <svg class="icon icon-sm icon-danger" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M15 2H9c-1.103 0-2 .897-2 2v2H3v2h2v12c0 1.103.897 2 2 2h10c1.103 0 2-.897 2-2V8h2V6h-4V4c0-1.103-.897-2-2-2zM9 4h6v2H9V4zm8 16H7V8h10v12z"></path></svg>\n                            </button>\n                        </li>`;if(t[0]&&"yes"===t[0].empty_conditions){const t=e("#empty_conditions").parent("td");e("#empty_conditions").remove(),t.append(`<div id="display_conditions" class="mb-3"><ul class="list-group">${o}</ul></div>`)}else n.length&&n.find("ul.list-group").append(o);setTimeout((()=>{e(c.close_modal_btn).trigger("click"),s(c.container)}),300)}else i.displayToast("danger",t?.toast_header_title||"Erro",t?.toast_body_title||t?.error_message||"Falha ao adicionar condição.")})).fail(((e,t,n)=>{console.error("AJAX failed:",t,n),i.displayToast("danger","Erro","Não foi possível enviar a condição.")})).always((()=>{o.html(a.html).width(a.width).height(a.height)}))})),e(document).off("click",".exclude-condition").on("click",".exclude-condition",(t=>{t.preventDefault();const n=e(t.currentTarget),o=n.closest(".list-group-item"),s=o.data("condition"),a=i.keepButtonState(n);n.html('<span class="spinner-border spinner-border-sm"></span>'),e.ajax({url:flexify_checkout_params.ajax_url,type:"POST",dataType:"json",data:{action:"exclude_condition_item",condition_index:s}}).done((t=>{t&&"success"===t.status?(i.displayToast("success",t.toast_header_title,t.toast_body_title),o.fadeOut(150,(function(){if(e(this).remove(),t[0]&&"yes"===t[0].empty_conditions){const i=e("#display_conditions").parent("td");e("#display_conditions").remove(),i.append(`<div id="empty_conditions" class="alert alert-info d-flex align-items-center">\n                                    <svg class="icon icon-info me-2" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M12 2C6.486 2 2 6.486 2 12s4.486 10 10 10 10-4.486 10-10S17.514 2 12 2zm0 18c-4.411 0-8-3.589-8-8s3.589-8 8-8 8 3.589 8 8-3.589 8-8 8z"></path><path d="M11 11h2v6h-2zm0-4h2v2h-2z"></path></svg>\n                                    <span>${t[0].empty_conditions_message||""}</span>\n                                </div>`)}}))):i.displayToast("danger",t?.toast_header_title||"Erro",t?.toast_body_title||"Falha ao excluir condição.")})).fail(((e,t,n)=>{console.error("AJAX failed:",t,n),i.displayToast("danger","Erro","Não foi possível excluir a condição.")})).always((()=>{n.html(a.html).width(a.width).height(a.height)}))})),o()},License:{activate:function(){e("#flexify_checkout_active_license").on("click",(function(n){n.preventDefault();let o=e(this),s=i.keepButtonState(o);e.ajax({url:t.ajax_url,method:"POST",data:{action:"flexify_checkout_active_license",license_key:e("#flexify_checkout_license_key").val()},beforeSend:function(){o.prop("disabled",!0).html('<span class="spinner-border spinner-border-sm"></span>')},success:function(e){try{"success"===e.status?(o.prop("disabled",!0).html(s.html),i.displayToast("success",e.toast_header_title,e.toast_body_title),setTimeout((function(){location.reload()}),1e3)):i.displayToast("error",e.toast_header_title,e.toast_body_title)}catch(e){console.log(e)}},complete:function(){o.prop("disabled",!1).html(s.html)},error:function(e,t,i){alert("AJAX error: "+i)}})}))},preLicenseActions:function(){e(".pro-version").prop("disabled",!0),e(document).on("click","#active_license_form",(function(){e("#popup-pro-notice").removeClass("show"),e('.flexify-checkout-wrapper a.nav-tab[href="#about"]').click(),e("html, body").animate({scrollTop:e("#enable_auto_updates").offset().top},300)}))},altLicenseUpload:function(){const n="#license_key_zone";function o(n,o){if(n){var s=n.name;o.children(".file-list").removeClass("d-none").text(s),o.addClass("file-processing"),o.append('<div class="spinner-border"></div>'),o.children(".drag-text, .drag-and-drop-file, .form-inter-bank-files").addClass("d-none");var a=new FormData;a.append("action","flexify_checkout_alternative_activation"),a.append("file",n),e.ajax({url:t.ajax_url,type:"POST",data:a,processData:!1,contentType:!1,success:function(e){try{"success"===e.status?(o.addClass("file-uploaded").removeClass("file-processing"),o.children(".spinner-border").remove(),o.append('<div class="upload-notice d-flex flex-column align-items-center"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="#22c55e" d="M12 2C6.486 2 2 6.486 2 12s4.486 10 10 10 10-4.486 10-10S17.514 2 12 2zm0 18c-4.411 0-8-3.589-8-8s3.589-8 8-8 8 3.589 8 8-3.589 8-8 8z"></path><path fill="#22c55e" d="M9.999 13.587 7.7 11.292l-1.412 1.416 3.713 3.705 6.706-6.706-1.414-1.414z"></path></svg><span>'+(e.dropfile_message||"")+"</span></div>"),o.children(".file-list").addClass("d-none"),setTimeout((function(){location.reload()}),1e3)):(o.addClass("invalid-file").removeClass("file-processing"),o.children(".spinner-border").remove(),o.children(".drag-text, .drag-and-drop-file, .form-inter-bank-files").removeClass("d-none"),o.children(".file-list").addClass("d-none"),(e.toast_header||e.toast_body)&&i.displayToast("danger",e.toast_header,e.toast_body))}catch(e){console.log(e)}},error:function(e,t,i){o.addClass("fail-upload").removeClass("file-processing"),console.error("AJAX Error:",t,i)}})}}e(document).on("dragover dragleave",n,(function(t){t.preventDefault(),e(this).toggleClass("drag-over","dragover"===t.type)})),e(document).on("drop",n,(t=>{t.preventDefault();var i=t.originalEvent.dataTransfer.files[0];e(t.currentTarget).hasClass("file-uploaded")||o(i,e(t.currentTarget))})),e(document).on("change","#upload_license_key",(function(t){t.preventDefault(),o(t.target.files[0],e(this).parents(".dropzone"))}))},deactivate:function(){e("#flexify_checkout_deactive_license").on("click",(function(n){if(n.preventDefault(),!confirm(flexify_checkout_params.confirm_deactivate_license))return;let o=e(this),s=i.keepButtonState(o);e.ajax({url:t.ajax_url,type:"POST",data:{action:"flexify_checkout_deactive_license"},beforeSend:function(){o.prop("disabled",!0).html('<span class="spinner-border spinner-border-sm"></span>')},success:function(e){try{"success"===e.status?(o.prop("disabled",!0).html(s.html),i.displayToast("success",e.toast_header_title,e.toast_body_title),setTimeout((function(){location.reload()}),1e3)):i.displayToast("error",e.toast_header_title,e.toast_body_title)}catch(e){console.log(e)}},error:function(){o.prop("disabled",!1).html(s.html)}})}))},sync:function(){e(document).on("click","#flexify_checkout_sync_license",(function(n){n.preventDefault();let o=e(this),s=i.keepButtonState(o);e.ajax({url:t.ajax_url,type:"POST",data:{action:"flexify_checkout_sync_license"},beforeSend:function(){o.prop("disabled",!0).html('<span class="spinner-border spinner-border-sm"></span>'),e(".license-details-item").each((function(){e(this).addClass("placeholder-content")}))},success:function(t){try{"success"===t.status?(i.displayToast("success",t.toast_header_title,t.toast_body_title),t.license&&(e("#fcw-license-status").html(t.license.status_html),e("#fcw-license-features").html(t.license.features_html),e("#fcw-license-type").html(t.license.type_html),e("#fcw-license-expiry").html(t.license.expire_html))):i.displayToast("error",t.toast_header_title,t.toast_body_title)}catch(e){console.log(e)}},complete:function(){o.prop("disabled",!1).html(s.html),e(".license-details-item").removeClass("placeholder-content")},error:function(e,t,i){console.error("AJAX Error:",t,i)}})}))},init:function(){this.activate(),this.preLicenseActions(),this.altLicenseUpload(),this.deactivate(),this.sync()}},integrationModules:{install:function(){e(".install-module").on("click",(function(n){n.preventDefault();let o=e(this),s=i.keepButtonState(o),a=o.data("plugin-url"),c=o.data("plugin-slug");e.ajax({type:"POST",url:t.ajax_url,data:{action:"flexify_checkout_install_modules",plugin_url:a,plugin_slug:c},beforeSend:function(){o.prop("disabled",!0).html('<span class="spinner-border spinner-border-sm"></span>')},success:function(e){"success"===e.status?(o.prop("disabled",!1).html(s.html),i.displayToast("success",e.toast_header_title,e.toast_body_title),setTimeout((function(){location.reload()}),500)):i.displayToast("error",e.toast_header_title,e.toast_body_title)},error:function(e){o.prop("disabled",!1).html(s.html),alert("Error installing the plugin: "+e.responseText)}})}))},activation:function(){e(".activate-plugin").on("click",(function(n){n.preventDefault();let o=e(this),s=i.keepButtonState(o),a=o.data("plugin-slug");e.ajax({type:"POST",url:t.ajax_url,data:{action:"flexify_checkout_activate_plugin",plugin_slug:a},beforeSend:function(){o.prop("disabled",!0).html('<span class="spinner-border spinner-border-sm"></span>')},success:function(e){"success"===e.status?(o.prop("disabled",!1).html(s.html),i.displayToast("success",e.toast_header_title,e.toast_body_title),setTimeout((function(){location.reload()}),500)):i.displayToast("error",e.toast_header_title,e.toast_body_title)},error:function(){o.prop("disabled",!1).html(s.html),alert("Erro ao ativar o plugin.")}})}))},init:function(){this.install(),this.activation()}},connectionListener:{toast:function(){navigator.onLine?e(".toast.toast-offline-connection").remove():i.displayToast("warning",t.offline_toast_header,t.offline_toast_body,"toast-offline-connection")},listener:function(){window.addEventListener("online",i.connectionListener.toast),window.addEventListener("offline",i.connectionListener.toast)},init:function(){this.listener(),i.connectionListener.toast()}},init:function(){this.initTabs(),this.saveOptions(),this.setupVisibilityControllers(),this.enforceMinOne(),this.filterDesignParameters(),this.mediaSelectors(),this.popups(),this.colorHelpers(),this.datepicker(),this.fieldsManager(),this.resetSettings(),this.themeSelector(),this.handleConditions(),this.License.init(),this.integrationModules.init(),this.connectionListener.init()}};e(document).ready((function(){i.init()})),window.Flexify_Checkout_Admin=i,e(document).trigger("flexify_checkout_admin_ready")}(jQuery);