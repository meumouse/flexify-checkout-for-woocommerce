!function(e){"use strict";const t=window.flexify_checkout_params||{};"yes"===t.debug_mode&&(console.log("[FLEXIFY CHECKOUT VERSION]: ",t.plugin_version),console.log("[FLEXIFY CHECKOUT] Admin params: ",t));var n={keepButtonState:function(e){var t=e.width(),n=e.height(),i=e.html();return e.width(t),e.height(n),{width:t,height:n,html:i}},displayToast:function(n,i,o,s=""){let a="";a="success"===n?'<svg class="icon icon-white me-2" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" style="fill: rgba(255, 255, 255, 1);"><path d="M12 2C6.486 2 2 6.486 2 12s4.486 10 10 10 10-4.486 10-10S17.514 2 12 2zm0 18c-4.411 0-8-3.589-8-8s3.589-8 8-8 8 3.589 8 8-3.589 8-8 8z"></path><path d="M9.999 13.587 7.7 11.292l-1.412 1.416 3.713 3.705 6.706-6.706-1.414-1.414z"></path></svg>':'<svg class="icon icon-white me-2" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" style="fill: rgba(255, 255, 255, 1);transform: ;msFilter:;"><path d="M12 2C6.486 2 2 6.486 2 12s4.486 10 10 10 10-4.486 10-10S17.514 2 12 2zm0 18c-4.411 0-8-3.589-8-8s3.589-8 8-8 8 3.589 8 8-3.589 8-8 8z"></path><path d="M11 11h2v6h-2zm0-4h2v2h-2z"></path></svg>',"error"===n&&(n="danger");const c=`<div class="toast toast-${n} ${s} show">\n                <div class="toast-header bg-${n} text-white">\n\t\t\t\t\t${a}\n\t\t\t\t\t<span class="me-auto">${i||""}</span>\n                    <button class="btn-close btn-close-white ms-2" type="button" aria-label="${t.i18n.close_aria_label_notice||"Close"}"></button>\n                </div>\n                <div class="toast-body">${o||""}</div>\n            </div>`;e(".flexify-checkout-wrapper").before(c),e(document).on("click",".toast .btn-close",(function(){e(".toast.show").fadeOut("fast")})),setTimeout((function(){e(`.toast-${n}`).fadeOut("fast",(function(){e(this).remove()}))}),3e3)},initTabs:function(){e((function(){let t=window.location.hash,n=localStorage.getItem("flexify_checkout_get_admin_tab_index");if(t){let n=e(`.flexify-checkout-wrapper a.nav-tab[href="${t}"]`);n.length&&n.click()}else null!==n?e(".flexify-checkout-wrapper a.nav-tab").eq(n).click():e('.flexify-checkout-wrapper a.nav-tab[href="#general"]').click()})),e(document).on("click",".flexify-checkout-wrapper a.nav-tab",(function(){let t=e(this).index();localStorage.setItem("flexify_checkout_get_admin_tab_index",t);let n=e(this).attr("href");return e(".flexify-checkout-wrapper a.nav-tab").removeClass("nav-tab-active"),e(".flexify-checkout-form .nav-content").removeClass("active"),e(this).addClass("nav-tab-active"),e(".flexify-checkout-form").find(n).addClass("active"),!1}))},saveOptions:function(){let i=e('form[name="flexify-checkout"]'),o=i.serialize();i.on("change input","input, select, textarea",(()=>{e("#flexify_checkout_save_options").prop("disabled",i.serialize()===o)})),e(document).on("click","#flexify_checkout_save_options",(s=>{s.preventDefault();let a=e(s.currentTarget),c=this.keepButtonState(a);e.ajax({url:t.ajax_url,type:"POST",data:{action:"flexify_checkout_save_settings",form_data:i.serialize()},beforeSend:function(){a.prop("disabled",!0).html('<span class="spinner-border spinner-border-sm"></span>')},success:e=>{try{"success"===e.status?(o=i.serialize(),n.displayToast("success",e.toast_header_title,e.toast_body_title)):n.displayToast("danger",e.toast_header_title,e.toast_body_title)}catch(e){console.log(e)}},error:function(e,t,n){console.error("AJAX request failed:",t,n)},complete:function(){a.html(c.html)}})}))},setupVisibilityControllers:function(){const t=(t,n,i=null)=>{const o=e(t),s=()=>{const t=o.val();if(o.is(":checkbox")){const t=o.is(":checked");"string"==typeof n&&e(n).toggleClass("d-none",!t)}else if("object"!=typeof n||Array.isArray(n)){if(Array.isArray(n)&&i){const o=n.includes(t);e(i).toggleClass("d-none",!o)}else if("string"==typeof n){const i="no"!==t&&"false"!==t&&""!==t;e(n).toggleClass("d-none",!i)}}else e.each(n,(function(n,i){e(i).toggleClass("d-none",t!==n)}))};e(document).off("change",t).on("change",t,s),s()};t("#enable_auto_apply_coupon_code",".show-coupon-code-enabled"),t("#enable_inter_bank_pix_api",".inter-bank-pix"),t("#enable_inter_bank_ticket_api",".inter-bank-slip"),t("#enable_fill_address",".require-auto-fill-address"),t("#enable_manage_fields",".step-checkout-fields-container"),t("#enable_field_masks",".require-input-mask"),t("#email_providers_suggestion",".require-email-suggestions-enabled"),t("#enable_inter_bank_pix_api",".require-enabled-inter-pix"),t("#enable_inter_bank_ticket_api",".require-enabled-inter-slip-bank"),t("#enable_animation_process_purchase",".require-process-animations-enabled"),t("#add_new_condition_component",{field:".specific-component-fields",payment:".specific-component-payment",shipping:".specific-component-shipping"}),t("#add_new_condition_user_function",{specific_user:".specific-users-container",specific_role:".specific-roles-container"}),t("#add_new_condition_product_filter",{specific_products:".specific-products",specific_categories:".specific-categories",specific_attributes:".specific-attributes"}),t("#add_new_condition_component_verification",{field:".specific-checkout-fields"}),t("#checkout_header_type",{logo:".header-styles-option-logo",text:".header-styles-option-text"}),t("#add_new_condition_component_type",["is","is_not","contains","not_contain","start_with","finish_with","bigger_then","less_than"],".condition-value"),t("#contact_page_thankyou",{custom_link:".require-custom-link-enabled"}),t("#enable_checkout_countdown",".require-countdown-enabled"),t("#checkout_countdown_action",{logout:".require-countdown-action-logout"}),t("#countdown_background_type",{custom:".require-custom-background-color"}),t("#countdown_font_color_type",{custom:".require-custom-font-color"})},enforceMinOne:function(){e(document).on("input",".allow-numbers-be-1",(function(){let t=parseFloat(e(this).val());(isNaN(t)||t<1)&&e(this).val(1)}))},filterDesignParameters:function(){e(document).on("keydown",".design-parameters",(function(e){let t=e.charCode||e.keyCode||0;return t>=96&&t<=105||t>=48&&t<=57||190===t||189===t||109===t||8===t}))},mediaSelectors:function(){const n=(t,n,i,o,s=!1)=>{let a;e(document).on("click",t,(function(t){t.preventDefault(),a||(a=wp.media.frames.file_frame=wp.media({title:i,button:{text:o},multiple:s}),a.on("select",(function(){const t=a.state().get("selection").first().toJSON();e(n).val(t.url).trigger("change")}))),a.open()}))};n("#flexify-checkout-search-header-logo",'input[name="search_image_header_checkout"]',t.i18n.set_logo_modal_title,t.i18n.use_this_image_title),n("#animation_process_purchase_file_1_trigger",'input[name="animation_process_purchase_file_1"]',t.i18n.set_animation_modal_title,t.i18n.set_animation_button_title),n("#animation_process_purchase_file_2_trigger",'input[name="animation_process_purchase_file_2"]',t.i18n.set_animation_modal_title,t.i18n.set_animation_button_title),n("#animation_process_purchase_file_3_trigger",'input[name="animation_process_purchase_file_3"]',t.i18n.set_animation_modal_title,t.i18n.set_animation_button_title)},displayModal:function(t,n,i){e(document).on("click",t,(function(t){t.preventDefault(),e(n).addClass("show")})),e(document).on("click",n,(function(t){t.target===this&&e(this).removeClass("show")})),e(document).on("click",i,(function(t){t.preventDefault(),e(n).removeClass("show")}))},popups:function(){this.displayModal("#inter_bank_credencials_settings","#inter_bank_credendials_container","#inter_bank_credendials_close"),this.displayModal("#inter_bank_pix_settings","#inter_bank_pix_container","#inter_bank_pix_close"),this.displayModal("#inter_bank_slip_settings","#inter_bank_slip_container","#inter_bank_slip_close"),this.displayModal("#require_inter_bank_module_trigger","#require_inter_bank_module_container","#require_inter_bank_module_close"),this.displayModal(".require-pro","#popup-pro-notice",".require-pro-close"),this.displayModal("#set_ip_api_service_trigger",".set-api-service-container",".set-api-service-close"),this.displayModal("#add_new_checkout_fields_trigger",".add-new-checkout-fields-container",".add-new-checkout-fields-close"),this.displayModal("#auto_fill_address_api_trigger",".auto-fill-address-api-container",".auto-fill-address-api-close"),this.displayModal("#fcw_manage_fonts_trigger","#fcw_manage_fonts_container","#fcw_close_fonts_manager"),this.displayModal("#fcw_reset_settings_trigger","#fcw_reset_settings_container","#fcw_close_reset"),this.displayModal("#add_new_checkout_condition_trigger","#add_new_checkout_condition_container","#close_add_new_checkout_condition"),this.displayModal("#set_email_providers_trigger","#set_email_providers_container","#close_set_email_providers"),this.displayModal("#set_process_purchase_animation_trigger","#set_process_purchase_animation_container","#close_set_process_purchase_animation"),this.displayModal("#set_countdown_trigger","#set_countdown_container","#close_set_countdown")},colorHelpers:function(){e(document).on("input",".get-color-selected",(function(){let t=e(this).val();e(this).closest(".color-container").find(".form-control-color").val(t)})),e(document).on("input",".form-control-color",(function(){let t=e(this).val();e(this).closest(".color-container").find(".get-color-selected").val(t)})),e(document).on("click",".reset-color",(function(t){t.preventDefault();let n=e(this).data("color");const i=e(this).closest(".color-container");i.find(".form-control-color").val(n),i.find(".get-color-selected").val(n).trigger("change")}))},datepicker:function(){const t=t=>{e(t).datepicker({format:"dd/mm/yyyy",todayHighlight:!0,language:"pt-BR"})};e(".dateselect").each((function(){t(this)})),e(document).on("focus",".dateselect",(function(){e(this).data("datepicker")||t(this)}))},fieldsManager:function(){var n=e("#flexify_checkout_step_1").sortable({connectWith:"#flexify_checkout_step_2",update:(e,t)=>{o(e,t,"1")}}),i=e("#flexify_checkout_step_2").sortable({connectWith:"#flexify_checkout_step_1",update:(e,t)=>{o(e,t,"2")}});function o(t,n,i){var o=n.item.closest(".step-container");e(o).find(".field-item").each((function(t){e(this).find(".change-priority").val(t+1).trigger("change")})),e(n.item).parent().siblings(".step-title").each((function(){e(this).closest(".step-container").find(".field-item").find(".change-step").val(i).trigger("change")}))}function s(t){var n=e("#"+t),i=n.find(".field-item");i.sort((function(t,n){return parseInt(e(t).find(".change-priority").val()||0,10)-parseInt(e(n).find(".change-priority").val()||0,10)})),i.detach().appendTo(n)}s("flexify_checkout_step_1"),s("flexify_checkout_step_2"),e(document).on("click",".flexify-checkout-step-trigger",(function(t){t.preventDefault(),e(t.target).closest(".field-item").addClass("active").children(".flexify-checkout-step-container").addClass("show"),e(n).sortable("option","disabled",!0),e(i).sortable("option","disabled",!0)})),e(document).on("click",".flexify-checkout-step-close-popup",(function(t){t.preventDefault(),e(this).closest(".flexify-checkout-step-container").removeClass("show"),e(".flexify-checkout-step-trigger").closest(".field-item").removeClass("active"),e(n).sortable("option","disabled",!1),e(i).sortable("option","disabled",!1)})),e(document).on("click",".flexify-checkout-step-container",(function(t){t.target===this&&(e(this).removeClass("show"),e(".flexify-checkout-step-trigger").closest(".field-item").removeClass("active"),e(n).sortable("option","disabled",!1),e(i).sortable("option","disabled",!1))})),e(document).on("click",".toggle-active-field",(function(t){let n=e(t.target).prop("checked"),i=e(".field-item.active");i.toggleClass("active",n).removeClass("inactive"),i.toggleClass("inactive",!n).removeClass("active")})),e(".field-item").hasClass("require-pro")&&(e(n).sortable("option","disabled",!0),e(i).sortable("option","disabled",!0)),e(document).on("click",".exclude-field",(n=>{if(n.preventDefault(),confirm(t.i18n.confirm_exclude_field)){var i=e(n.currentTarget),o=this.keepButtonState(i),s=i.data("exclude");i.html('<span class="spinner-border spinner-border-sm"></span>'),e.ajax({url:t.ajax_url,type:"POST",data:{action:"remove_checkout_fields",field_to_remove:s},success:t=>{try{t&&"success"===t.status?(e("#"+t.field).fadeOut(500,(function(){e(this).remove()})),this.displayToast("success",t.toast_header_title,t.toast_body_title)):(this.displayToast("danger",t.toast_header_title,t.toast_body_title),console.error('Invalid JSON response or missing "status" field:',t))}catch(e){console.error("Error parsing JSON:",e)}},error:function(e,t,n){console.error("AJAX request failed:",t,n)},complete:()=>{i.html(o.html).width(o.width).height(o.height)}})}})),e(document).on("blur","#checkout_field_name",(function(){var n=`billing_${e(this).val()}`;""!==e(this).val()&&(e("#checkout_field_name").before('<span id="check_field_id" class="spinner-border spinner-border-sm" style="position:absolute;padding:0.3rem;border-radius:100%!important;right:1rem;z-index:2;top:0.7rem;"></span>'),e.ajax({url:t.ajax_url,type:"POST",data:{action:"check_field_availability",field_name:n},success:function(t){try{"success"===t.status&&(e("#check_field_id").remove(),!0===t.available?(e("#check_field_availability").addClass("d-none"),e("#set_field_id").removeClass("invalid-option"),e("#checkout_field_name_concat").val(n)):(e("#check_field_availability").removeClass("d-none"),e("#set_field_id").addClass("invalid-option"),e("#checkout_field_name_concat").val("")))}catch(e){console.error("Error parsing JSON:",e)}},error:function(e,t,n){console.error("AJAX request failed:",t,n)}}))})),e(document).on("change","#checkout_field_type",(function(){let t=e(this).val();"select"===t?(e(".require-add-new-field-select").removeClass("d-none"),e(".require-add-new-field-multicheckbox").addClass("d-none")):"multicheckbox"===t?(e(".require-add-new-field-multicheckbox").removeClass("d-none"),e(".require-add-new-field-select").addClass("d-none")):e(".require-add-new-field-select, .require-add-new-field-multicheckbox").addClass("d-none")})),e(document).on("click","#add_new_options_to_select",(function(t){t.preventDefault();let n=e("#add_new_field_select_option_value"),i=e("#add_new_field_select_option_title"),o=`<div class="d-flex align-items-center mb-3 option-container" data-option="${n.val()}">\n                    <div class="input-group me-3">\n                        <span class="input-group-text d-flex align-items-center justify-content-center w-25">${n.val()}</span>\n                        <span class="input-group-text d-flex align-items-center justify-content-center w-75">${i.val()}</span>\n                    </div>\n                    <button class="btn btn-outline-danger btn-icon rounded-3 exclude-option-select" data-exclude="${n.val()}">\n                        <svg class="icon icon-danger" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M15 2H9c-1.103 0-2 .897-2 2v2H3v2h2v12c0 1.103.897 2 2 2h10c1.103 0 2-.897 2-2V8h2V6h-4V4c0-1.103-.897-2-2-2zM9 4h6v2H9V4zm8 16H7V8h10v12z"></path></svg>\n                    </button>\n                </div>`;e("#preview_options_container").append(o),e("#preview_select_new_field").append(new Option(i.val(),n.val())),n.val(""),i.val("")})),e(document).on("click",".exclude-option-select",(function(t){t.preventDefault();let n=e(this).data("exclude");e(this).closest(".option-container").remove(),e(`#preview_select_new_field > option[value="${n}"]`).remove()})),e(document).on("click","#add_new_options_to_multicheckbox",(function(t){t.preventDefault();let n=e("#add_new_field_multicheckbox_option_id"),i=e("#add_new_field_multicheckbox_option_title"),o=`<div class="form-check mb-2 multicheckbox-container">\n                    <input class="form-check-input" type="checkbox" id="${n.val()}">\n                    <label class="form-check-label" for="${n.val()}">${i.val()}</label>\n                    <button class="btn btn-outline-danger btn-icon rounded-3 ms-3 exclude-option-multicheckbox" data-exclude="${n.val()}">\n                        <svg class="icon icon-danger" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M15 2H9c-1.103 0-2 .897-2 2v2H3v2h2v12c0 1.103.897 2 2 2h10c1.103 0 2-.897 2-2V8h2V6h-4V4c0-1.103-.897-2-2-2zM9 4h6v2H9V4zm8 16H7V8h10v12z"></path></svg>\n                    </button>\n                </div>`;e("#preview_multicheckbox_container").append(o),n.val(""),i.val("")})),e(document).on("click",".exclude-option-multicheckbox",(function(t){t.preventDefault(),e(this).closest(".multicheckbox-container").remove()})),e(document).on("change","#required_field",(function(){e(this).val(e(this).is(":checked")?"yes":"no")})),e(document).on("keyup input",".get-name-field",(function(){let t=e(this).val(),n=e(this).closest(".flexify-checkout-step-container.show");n.find("h5.popup-title .field-name").text(t),n.parent(".field-item").children(".field-name").text(t)})),e(document).on("click","#fcw_add_new_field",(n=>{n.preventDefault();var i=e(n.currentTarget),o=i.text(),s=this.keepButtonState(i);i.html('<span class="spinner-border spinner-border-sm"></span>');var a=e("#checkout_field_name_concat").val(),c=e("#checkout_field_type").val(),l=e("#checkout_field_title").val(),r=e("#required_field").val(),d=e("#field_position").val(),f=e("#field_classes").val(),_=e("#field_label_classes").val(),p=e("#field_step").val(),u=e("#field_source").val(),h=e("#field_input_mask").val(),m=(t.get_array_checkout_fields?t.get_array_checkout_fields.length:0)+1,g=[];"select"===c&&e("#preview_select_new_field option").each((function(){g.push({value:e(this).val(),text:e(this).text()})})),e.ajax({url:t.ajax_url,type:"POST",data:{action:"add_new_field_to_checkout",get_field_id:a,get_field_type:c,get_field_label:l,get_field_required:r,get_field_position:d,get_field_classes:f,get_field_label_classes:_,get_field_step:p,get_field_source:u,get_field_priority:m,get_field_options_for_select:g,input_mask:h},success:t=>{try{if("success"===t.status){e("#fcw_add_new_field").text(o);var n=e("#"+a);n.length?n.replaceWith(t.field_html):"1"===p?e("#flexify_checkout_step_1").append(t.field_html):"2"===p&&e("#flexify_checkout_step_2").append(t.field_html),this.displayToast("success",t.toast_header_title,t.toast_body_title),e(".add-new-checkout-fields-container").removeClass("show"),e("#checkout_field_name").val(""),e("#checkout_field_name_concat").val(""),e("#checkout_field_type").val("text"),e("#checkout_field_title").val(""),e("#required_field").val("no").prop("checked",!1),e("#field_position").val("left"),e("#field_classes").val(""),e("#field_label_classes").val(""),e("#field_step").val("1"),e("#field_source").val(""),e("#field_input_mask").val(""),e(".require-add-new-field-select").addClass("d-none"),e("#preview_select_new_field > option").remove(),e("#preview_options_container").html("")}else this.displayToast("danger",t.toast_header_title,t.toast_body_title),console.error('Invalid JSON response or missing "status" field:',t)}catch(e){console.error("Error parsing JSON:",e)}},error:function(e,t,n){console.error("AJAX request failed:",t,n)},complete:()=>{i.html(s.html).width(s.width).height(s.height)}})})),e(document).on("click",".exclude-option-select-live",(n=>{if(n.preventDefault(),!confirm(t.i18n.confirm_remove_option))return;let i=e(n.currentTarget),o=this.keepButtonState(i),s=i.data("field-id"),a=i.data("option");i.html('<span class="spinner-border spinner-border-sm"></span>'),e.ajax({url:t.ajax_url,type:"POST",data:{action:"remove_select_option",field_id:s,exclude_option:a},success:e=>{try{"success"===e.status?(i.closest(".option-container-live").remove(),this.displayToast("success",e.toast_header_title,e.toast_body_title)):(this.displayToast("danger",e.toast_header_title,e.toast_body_title),console.error('Invalid JSON response or missing "status" field:',e))}catch(e){console.error("Error parsing JSON:",e)}},error:function(e,t,n){console.error("AJAX request failed:",t,n)},complete:()=>{i.html(o.html).width(o.width).height(o.height)}})})),e(document).on("click","#add_new_select_option_live",(function(n){n.preventDefault();const i=`<div id="new_select_option_live_preview" class="d-flex align-items-center justify-content-between mb-4">\n                    <div class="d-grid me-3">\n                        <div class="input-group mb-3">\n                            <span class="input-group-text w-fit">${t.i18n.new_option_value}</span>\n                            <input type="text" id="add_new_field_select_option_value_live" class="form-control input-control-wd-12" value="" placeholder="${t.i18n.placeholder_new_option_value}">\n                        </div>\n                        <div class="input-group">\n                            <span class="input-group-text w-fit">${t.i18n.new_option_title}</span>\n                            <input type="text" id="add_new_field_select_option_title_live" class="form-control input-control-wd-12" value="" placeholder="${t.i18n.placeholder_new_option_title}">\n                        </div>\n                    </div>\n                    <button id="add_new_options_to_select_live" class="btn btn-icon btn-icon-lg btn-outline-secondary">\n                        <svg class="icon icon-dark" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 11h-6V5h-2v6H5v2h6v6h2v-6h6z"></path></svg>\n                    </button>\n                </div>`;e(this).prop("disabled",!0).before(i)})),e(document).on("click","#add_new_options_to_select_live",(n=>{n.preventDefault();let i=e(n.currentTarget),o=this.keepButtonState(i),s=e(".field-item.active").attr("id"),a=e("#add_new_field_select_option_value_live").val(),c=e("#add_new_field_select_option_title_live").val();const l=`<div class="d-flex align-items-center mb-3 option-container-live" data-option="${a}">\n                    <div class="input-group me-3">\n                        <span class="input-group-text d-flex align-items-center justify-content-center py-2 w-25">${a}</span>\n                        <span class="input-group-text d-flex align-items-center justify-content-center w-75">${c}</span>\n                    </div>\n                    <button class="btn btn-outline-danger btn-icon rounded-3 exclude-option-select-live" data-field-id="${s}" data-option="${a}">\n                        <svg class="icon icon-danger" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M15 2H9c-1.103 0-2 .897-2 2v2H3v2h2v12c0 1.103.897 2 2 2h10c1.103 0 2-.897 2-2V8h2V6h-4V4c0-1.103-.897-2-2-2zM9 4h6v2H9V4zm8 16H7V8h10v12z"></path></svg>\n                    </button>\n                </div>`;i.html('<span class="spinner-border spinner-border-sm"></span>'),e.ajax({url:t.ajax_url,type:"POST",data:{action:"add_new_option_select_live",field_id:s,option_value:a,option_title:c},success:t=>{try{"success"===t.status?(e("#add_new_select_option_live").prop("disabled",!1),e("#new_select_option_live_preview").remove(),e(".field-item.active .options-container-live").append(l),this.displayToast("success",t.toast_header_title,t.toast_body_title)):(this.displayToast("danger",t.toast_header_title,t.toast_body_title),console.error('Invalid JSON response or missing "status" field:',t))}catch(e){console.error("Error parsing JSON:",e)}},error:function(e,t,n){console.error("AJAX request failed:",t,n)},complete:()=>{i.html(o.html).width(o.width).height(o.height)}})}))},resetSettings:function(){e(document).on("click","#confirm_reset_settings",(function(t){t.preventDefault();let i=e(this),o=n.keepButtonState(i);e.ajax({url:flexify_checkout_params.ajax_url,type:"POST",data:{action:"flexify_checkout_reset_plugin_action"},beforeSend:function(){i.html('<span class="spinner-border spinner-border-sm"></span>')},success:function(t){try{"success"===t.status?(i.html(o.html),e("#fcw_close_reset").click(),n.displayToast("success",t.toast_header_title,t.toast_body_title),setTimeout((function(){location.reload()}),1e3)):n.displayToast("error",t.toast_header_title,t.toast_body_title)}catch(e){console.log(e)}}})}))},themeSelector:function(){e(document).on("click",".card-theme-item",(function(t){let n=e(this),i=n.data("theme");n.hasClass("coming-soon")||(e(".card-theme-item").removeClass("active"),n.addClass("active"),e('input[name="flexify_checkout_theme"]').val(i).change())}))},handleConditions:function(){const t=(e,t=250)=>{let n;return function(...i){clearTimeout(n),n=setTimeout((()=>e.apply(this,i)),t)}},i=t=>e(t).val()||"none",o=()=>{const t=i(c.type_rule),n=i(c.component),o=i(c.component_field),s=i(c.payment),a=i(c.shipping),l=i(c.verification_condition),r=i(c.verification_condition_field),d=i(c.condition),f=e(c.condition_value).val()||"";let _="none"!==t&&"none"!==n&&"none"!==d;"field"===n&&"none"===o&&(_=!1),"payment"===n&&"none"===s&&(_=!1),"shipping"===n&&"none"===a&&(_=!1),"field"===l&&"none"===r&&(_=!1),["is","is_not","contains","not_contain","start_with","finish_with","bigger_then","less_than"].includes(d)&&""===f.trim()&&(_=!1),e(c.submit).prop("disabled",!_)},s=t=>{const n=e(t);n.find("select").each((function(){const t=e(this).find("option:first").val();e(this).val(t).trigger("change")})),n.find('input[type="text"], input[type="search"], input[type="number"]').val(""),e(c.products_box).empty().removeClass("has-items"),e(c.categories_box).empty().removeClass("has-items"),e(c.attributes_box).empty().removeClass("has-items"),e(c.users_box).empty().removeClass("has-items"),l.clear(),r.clear(),d.clear(),f.clear(),o()},a=(n,i,o,s,a)=>{const c=t((function(t){const s=e(t.target).val().trim(),a=e(i);s.length<3?a.empty().removeClass("has-items"):(a.next(".specific-search-spinner").length||e(t.target).after('<i class="spinner-border specific-search-spinner"></i>'),e.ajax({url:flexify_checkout_params.ajax_url,type:"POST",dataType:"html",data:{action:o,search_query:s}}).done((t=>{e(n).parent("div").find(".specific-search-spinner").remove(),a.html(t).addClass("has-items")})).fail(((t,i,o)=>{console.error("AJAX search failed:",i,o),e(n).parent("div").find(".specific-search-spinner").remove()})))}),300);e(document).off("keyup",n).on("keyup",n,c),e(document).off("click",`${i} li.list-group-item`).on("click",`${i} li.list-group-item`,(function(){const t=e(this).data(s);(t||0===t)&&(e(this).toggleClass("selected").hasClass("selected")?a.add(t):a.delete(t))}))},c={container:"#add_new_condition_container_master",submit:"#add_new_condition_submit",type_rule:"#add_new_condition_type_rule",component:"#add_new_condition_component",component_field:"#add_new_condition_specific_field_component",verification_condition:"#add_new_condition_component_verification",verification_condition_field:"#add_new_condition_specific_field",condition:"#add_new_condition_component_type",condition_value:"#add_new_condition_get_condition_value",payment:"#add_new_condition_specific_payment_component",shipping:"#add_new_condition_specific_shipping_component",user_function:"#add_new_condition_user_function",user_role:"#add_new_condition_specific_user_role",product_filter:"#add_new_condition_product_filter",product_input:".product-search",category_input:".category-search",attribute_input:".attribute-search",user_input:".user-search",products_box:"#get_specific_products",categories_box:"#get_specific_categories",attributes_box:"#get_specific_attribute",users_box:"#get_specific_users",close_modal_btn:"#close_add_new_checkout_condition"},l=new Set,r=new Set,d=new Set,f=new Set;e(document).off("change keyup",`${c.container} select, ${c.container} input`).on("change keyup",`${c.container} select, ${c.container} input`,o),e(document).off("change",c.product_filter).on("change",c.product_filter,o);const _=e(c.condition).find("option").clone();e(document).on("change",c.verification_condition_field,(function(){const t=e(this).find("option:selected").data("type"),n=e(c.condition);n.html(_.clone()),"checkbox"===t&&n.find("option").each((function(){const t=e(this).val();["none","checked","not_checked"].includes(t)||e(this).remove()})),n.val("none").trigger("change")})),e(document).on("change",c.verification_condition,(function(){"field"!==e(this).val()?e(c.condition).html(_.clone()).val("none").trigger("change"):e(c.verification_condition_field).trigger("change")})),a(c.product_input,c.products_box,"get_woo_products_ajax","product-id",l),a(c.category_input,c.categories_box,"get_woo_categories_ajax","category-id",r),a(c.attribute_input,c.attributes_box,"get_woo_attributes_ajax","attribute-id",d),a(c.user_input,c.users_box,"search_users_ajax","user-id",f),e(document).off("click",c.submit).on("click",c.submit,(t=>{t.preventDefault();const o=e(t.currentTarget),a=n.keepButtonState(o);o.html('<span class="spinner-border spinner-border-sm"></span>');const _=(()=>{const t=new FormData;t.set("action","add_new_checkout_condition"),t.set("type_rule",i(c.type_rule)),t.set("component",i(c.component)),t.set("component_field",i(c.component_field)),t.set("verification_condition",i(c.verification_condition)),t.set("verification_condition_field",i(c.verification_condition_field));const n=i(c.condition);t.set("condition",n),["checked","not_checked"].includes(n)?t.set("condition_value",""):t.set("condition_value",e(c.condition_value).val()||""),t.set("payment_method",i(c.payment)),t.set("shipping_method",i(c.shipping));const o=i(c.user_function);t.set("filter_user",i(c.user_role)),"specific_user"===o?t.set("specific_user",JSON.stringify([...f])):"specific_role"===o&&t.set("specific_role",i(c.user_role));const s=i(c.product_filter);return t.set("product_filter",s),"specific_products"===s&&t.set("specific_products",JSON.stringify([...l])),"specific_categories"===s&&t.set("specific_categories",JSON.stringify([...r])),"specific_attributes"===s&&t.set("specific_attributes",JSON.stringify([...d])),t})();e.ajax({url:flexify_checkout_params.ajax_url,type:"POST",data:_,processData:!1,contentType:!1,dataType:"json"}).done((t=>{if(t&&"success"===t.status){n.displayToast("success",t.toast_header_title,t.toast_body_title);const i=e("#display_conditions"),o=`<li class="list-group-item d-flex align-items-center justify-content-between">\n                            <div class="d-grid">\n                                <div class="mb-2">${t.condition_line_1||""}</div>\n                                <div>${t.condition_line_2||""}</div>\n                            </div>\n                            <button class="exclude-condition btn btn-icon btn-sm btn-outline-danger rounded-3 ms-3">\n                                <svg class="icon icon-sm icon-danger" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M15 2H9c-1.103 0-2 .897-2 2v2H3v2h2v12c0 1.103.897 2 2 2h10c1.103 0 2-.897 2-2V8h2V6h-4V4c0-1.103-.897-2-2-2zM9 4h6v2H9V4zm8 16H7V8h10v12z"></path></svg>\n                            </button>\n                        </li>`;if(t[0]&&"yes"===t[0].empty_conditions){const t=e("#empty_conditions").parent("td");e("#empty_conditions").remove(),t.append(`<div id="display_conditions" class="mb-3"><ul class="list-group">${o}</ul></div>`)}else i.length&&i.find("ul.list-group").append(o);setTimeout((()=>{e(c.close_modal_btn).trigger("click"),s(c.container)}),300)}else n.displayToast("danger",t?.toast_header_title||"Erro",t?.toast_body_title||t?.error_message||"Falha ao adicionar condição.")})).fail(((e,t,i)=>{console.error("AJAX failed:",t,i),n.displayToast("danger","Erro","Não foi possível enviar a condição.")})).always((()=>{o.html(a.html).width(a.width).height(a.height)}))})),e(document).off("click",".exclude-condition").on("click",".exclude-condition",(t=>{t.preventDefault();const i=e(t.currentTarget),o=i.closest(".list-group-item"),s=o.data("condition"),a=n.keepButtonState(i);i.html('<span class="spinner-border spinner-border-sm"></span>'),e.ajax({url:flexify_checkout_params.ajax_url,type:"POST",dataType:"json",data:{action:"exclude_condition_item",condition_index:s}}).done((t=>{t&&"success"===t.status?(n.displayToast("success",t.toast_header_title,t.toast_body_title),o.fadeOut(150,(function(){if(e(this).remove(),t[0]&&"yes"===t[0].empty_conditions){const n=e("#display_conditions").parent("td");e("#display_conditions").remove(),n.append(`<div id="empty_conditions" class="alert alert-info d-flex align-items-center">\n                                    <svg class="icon icon-info me-2" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M12 2C6.486 2 2 6.486 2 12s4.486 10 10 10 10-4.486 10-10S17.514 2 12 2zm0 18c-4.411 0-8-3.589-8-8s3.589-8 8-8 8 3.589 8 8-3.589 8-8 8z"></path><path d="M11 11h2v6h-2zm0-4h2v2h-2z"></path></svg>\n                                    <span>${t[0].empty_conditions_message||""}</span>\n                                </div>`)}}))):n.displayToast("danger",t?.toast_header_title||"Erro",t?.toast_body_title||"Falha ao excluir condição.")})).fail(((e,t,i)=>{console.error("AJAX failed:",t,i),n.displayToast("danger","Erro","Não foi possível excluir a condição.")})).always((()=>{i.html(a.html).width(a.width).height(a.height)}))})),o()},fontsManager:{fonts:e.extend(!0,{},t.fonts_library||{}),getI18n:function(){return t.i18n&&t.i18n.fonts?t.i18n.fonts:{}},bindEvents:function(){const t=this;e(document).off("change.fcw","#fcw-font-type").on("change.fcw","#fcw-font-type",(function(){t.toggleFields(e(this).val())})),e(document).off("click.fcw","#fcw-cancel-font-edit").on("click.fcw","#fcw-cancel-font-edit",(function(e){e.preventDefault(),t.resetForm()})),e(document).off("click.fcw",".fcw-font-edit").on("click.fcw",".fcw-font-edit",(function(n){n.preventDefault(),t.fillForm(e(this).data("font-id"))})),e(document).off("click.fcw",".fcw-font-delete").on("click.fcw",".fcw-font-delete",(function(n){n.preventDefault(),t.delete(e(this).data("font-id"),e(this))})),e(document).on("click","#fcw_manage_fonts_trigger",(function(){e("#fcw-font-type").trigger("change")}))},toggleFields:function(t){const n=e(".fcw-font-upload-fields"),i=e(".fcw-font-google-fields");"upload"===t?(n.removeClass("d-none"),i.addClass("d-none")):(i.removeClass("d-none"),n.addClass("d-none"))},extractFilename:function(e){if(!e)return"";try{return decodeURIComponent(e).split("/").pop()}catch(t){return e.split("/").pop()}},generateSlug:function(e){return e?e.toString().normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().trim().replace(/[^a-z0-9\-\_\s]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-"):""},escapeHtml:function(e){if(null==e)return"";const t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"};return e.toString().replace(/[&<>"']/g,(function(e){return t[e]}))},updateFileLabels:function(t){const n=this.getI18n().upload_keep_file||"";t&&t.woff2?e("#fcw-font-file-woff2-current").text(n?`${n}: ${this.extractFilename(t.woff2)}`:this.extractFilename(t.woff2)):e("#fcw-font-file-woff2-current").text(""),t&&t.woff?e("#fcw-font-file-woff-current").text(n?`${n}: ${this.extractFilename(t.woff)}`:this.extractFilename(t.woff)):e("#fcw-font-file-woff-current").text("")},resetForm:function(){const t=e("#fcw-fonts-form");t.length&&(e("#fcw-font-name").val(""),e("#fcw-font-url").val(""),e("#fcw-font-weight").val("400"),e("#fcw-font-style").val("normal"),e("#fcw-font-type").val("google"),t.find('input[type="file"]').val("")),e("#fcw-font-id").val(""),e("#fcw-font-is-new").val("yes"),e("#fcw-cancel-font-edit").addClass("d-none");const n=e("#fcw-font-form-title");n.text(this.addTitle||n.text()),e("#fcw-existing-woff2").val(""),e("#fcw-existing-woff").val(""),this.updateFileLabels({});const i=e("#fcw-font-type").val();this.toggleFields(i)},fillForm:function(t){if(!t||!this.fonts[t])return;const n=this.fonts[t];e("#fcw-font-id").val(t),e("#fcw-font-is-new").val("no"),e("#fcw-font-name").val(n.font_name||""),e("#fcw-font-type").val(n.type||"google"),e("#fcw-font-url").val(n.font_url||""),e("#fcw-font-weight").val(n.font_weight||"400"),e("#fcw-font-style").val(n.font_style||"normal"),e("#fcw-existing-woff2").val(n.font_files&&n.font_files.woff2?n.font_files.woff2:""),e("#fcw-existing-woff").val(n.font_files&&n.font_files.woff?n.font_files.woff:""),e("#fcw-existing-ttf").val(n.font_files&&n.font_files.ttf?n.font_files.ttf:""),this.updateFileLabels(n.font_files||{}),e("#fcw-fonts-form").find('input[type="file"]').val(""),this.toggleFields(n.type||"google"),e("#fcw-cancel-font-edit").removeClass("d-none"),e("#fcw-font-form-title").text(this.editTitle||e("#fcw-font-form-title").text())},renderList:function(){if(!e("#fcw-fonts-list").length)return;const t=this.fonts||{},n=this.getI18n(),i=[],o=Object.keys(t);o.length&&o.forEach((e=>{const o=t[e]||{},s="upload"===o.type?n.type_upload||"Upload":n.type_google||"Google Fonts",a="default"===o.source,c=a?"bg-primary":"bg-info",l=a?n.badge_default||"Padrão":n.badge_custom||"Personalizada",r=o.font_name||e,d=this.escapeHtml(e),f=this.escapeHtml(r),_=this.escapeHtml(s),p=this.escapeHtml(l);i.push(`<li class="list-group-item d-flex flex-column flex-lg-row align-items-lg-center justify-content-between fcw-font-item" data-font-id="${d}" data-font-type="${this.escapeHtml(o.type||"google")}" data-font-source="${this.escapeHtml(o.source||"custom")}">\n                                <div class="fcw-font-item__info">\n                                    <span class="fw-semibold">${f}</span>\n                                    <span class="badge bg-secondary ms-2">${_}</span>\n                                    <span class="badge ${c} ms-1">${p}</span>\n                                </div>\n                                <div class="fcw-font-item__actions mt-3 mt-lg-0">\n                                    ${a?`<span class="text-muted small">${p}</span>`:`\n                                        <button type="button" class="btn btn-sm btn-outline-secondary fcw-font-edit" data-font-id="${d}">${this.escapeHtml(n.edit||"Editar")}</button>\n                                        <button type="button" class="btn btn-sm btn-outline-danger ms-2 fcw-font-delete" data-font-id="${d}">${this.escapeHtml(n.delete||"Excluir")}</button>`}\n                                </div>\n                            </li>`)})),i.length||i.push(`<li class="list-group-item text-muted">${n.empty||""}</li>`),e("#fcw-fonts-list").html(i.join(""));const s=o.some((e=>"default"!==((t[e]||{}).source||"custom")));e("#fcw-fonts-empty").length&&e("#fcw-fonts-empty").toggleClass("d-none",s),this.updateSelectOptions()},updateSelectOptions:function(){const t=e("#set_font_family");if(!t.length)return;const n=t.val(),i=[];if(Object.keys(this.fonts||{}).forEach((e=>{const t=this.fonts[e]||{},n=this.escapeHtml(t.font_name||e);i.push(`<option value="${this.escapeHtml(e)}">${n}</option>`)})),t.html(i.join("")),n&&this.fonts[n])t.val(n);else{const e=Object.keys(this.fonts||{});e.length&&t.val(e[0])}t.trigger("change")},save:function(){e(document).on("click","#fcw-save-font",(function(i){i.preventDefault();const o=e(this),s=e("#fcw-fonts-form"),a=n.keepButtonState(o),c=(e("#fcw-font-name").val()||"").trim(),l="yes"===e("#fcw-font-is-new").val();let r=e("#fcw-font-id").val();l&&(r=n.fontsManager.generateSlug(c),e("#fcw-font-id").val(r));const d=new FormData;s.length&&s.find("input, select, textarea").each((function(){const t=e(this),n=t.attr("name");if(!n)return;const i=(t.attr("type")||"").toLowerCase();"file"!==i&&("checkbox"!==i&&"radio"!==i||t.is(":checked"))&&d.append(n,t.val())})),d.append("action","flexify_checkout_save_font"),d.append("nonce",t.nonces&&t.nonces.fonts?t.nonces.fonts:""),d.set("font_name",c),d.set("font_id",r);const f=e("#fcw-font-type").val();if(d.set("font_type",f),"upload"!==f)d.delete("font_file"),d.delete("font_weight"),d.delete("font_style"),d.set("font_url",(e("#fcw-font-url").val()||"").trim());else{d.set("font_weight",(e("#fcw-font-weight").val()||"400").trim()),d.set("font_style",(e("#fcw-font-style").val()||"normal").trim());const n=e("#fcw-font-file"),i=n&&n[0]&&n[0].files?n[0].files[0]:null;if(d.delete("font_file"),i&&d.append("font_file",i,i.name),"yes"===t.debug_mode){console.log("Arquivo selecionado:",i);for(const[e,t]of d.entries())console.log("FD:",e,t instanceof File?`${t.name} (${t.size})`:t)}}e.ajax({url:t.ajax_url,method:"POST",data:d,processData:!1,contentType:!1,beforeSend:()=>{o.prop("disabled",!0).html('<span class="spinner-border spinner-border-sm"></span>')},success:i=>{if(i&&"success"===i.status)n.fontsManager.fonts=i.fonts||n.fontsManager.fonts,n.fontsManager.renderList(),n.fontsManager.resetForm(),i.current_font&&e("#set_font_family").val(i.current_font).trigger("change"),n.displayToast("success",i.toast_header_title,i.toast_body_title);else{const e=i?.toast_body_title||(t.i18n?.fonts?.font_exists?t.i18n.fonts.font_exists:"Não foi possível salvar a fonte.");n.displayToast("danger",i?.toast_header_title||"Erro",e)}},error:()=>{n.displayToast("danger","Erro","Não foi possível salvar a fonte.")},complete:()=>{o.prop("disabled",!1).html(a.html)}})}))},delete:function(i,o){if(!i)return;const s=this.getI18n();if(!window.confirm(s.confirm_delete||"Tem certeza que deseja excluir esta fonte?"))return;let a=null;o&&o.length&&(a=n.keepButtonState(o),o.html('<span class="spinner-border spinner-border-sm"></span>').prop("disabled",!0)),e.ajax({url:t.ajax_url,method:"POST",dataType:"json",data:{action:"flexify_checkout_delete_font",font_id:i,nonce:t.nonces?t.nonces.fonts:""}}).done((t=>{t&&"success"===t.status?(this.fonts=t.fonts||this.fonts,this.renderList(),t.current_font&&e("#set_font_family").val(t.current_font).trigger("change"),e("#fcw-font-id").val()===i&&this.resetForm(),n.displayToast("success",t.toast_header_title,t.toast_body_title)):n.displayToast("danger",t?.toast_header_title||"Erro",t?.toast_body_title||"Não foi possível remover a fonte.")})).fail((()=>{n.displayToast("danger","Erro","Não foi possível remover a fonte.")})).always((()=>{o&&o.length&&a&&o.prop("disabled",!1).html(a.html).width(a.width).height(a.height)}))},init:function(){this.renderList(),this.resetForm(),this.bindEvents(),this.save()}},License:{activate:function(){e("#flexify_checkout_active_license").on("click",(function(i){i.preventDefault();let o=e(this),s=n.keepButtonState(o);e.ajax({url:t.ajax_url,method:"POST",data:{action:"flexify_checkout_active_license",license_key:e("#flexify_checkout_license_key").val()},beforeSend:function(){o.prop("disabled",!0).html('<span class="spinner-border spinner-border-sm"></span>')},success:function(e){try{"success"===e.status?(o.prop("disabled",!0).html(s.html),n.displayToast("success",e.toast_header_title,e.toast_body_title),setTimeout((function(){location.reload()}),1e3)):n.displayToast("error",e.toast_header_title,e.toast_body_title)}catch(e){console.log(e)}},complete:function(){o.prop("disabled",!1).html(s.html)},error:function(e,t,n){alert("AJAX error: "+n)}})}))},preLicenseActions:function(){e(".pro-version").prop("disabled",!0),e(document).on("click","#active_license_form",(function(){e("#popup-pro-notice").removeClass("show"),e('.flexify-checkout-wrapper a.nav-tab[href="#about"]').click(),e("html, body").animate({scrollTop:e("#enable_auto_updates").offset().top},300)}))},altLicenseUpload:function(){const i="#license_key_zone";function o(i,o){if(i){var s=i.name;o.children(".file-list").removeClass("d-none").text(s),o.addClass("file-processing"),o.append('<div class="spinner-border"></div>'),o.children(".drag-text, .drag-and-drop-file, .form-inter-bank-files").addClass("d-none");var a=new FormData;a.append("action","flexify_checkout_alternative_activation"),a.append("file",i),e.ajax({url:t.ajax_url,type:"POST",data:a,processData:!1,contentType:!1,success:function(e){try{"success"===e.status?(o.addClass("file-uploaded").removeClass("file-processing"),o.children(".spinner-border").remove(),o.append('<div class="upload-notice d-flex flex-column align-items-center"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="#22c55e" d="M12 2C6.486 2 2 6.486 2 12s4.486 10 10 10 10-4.486 10-10S17.514 2 12 2zm0 18c-4.411 0-8-3.589-8-8s3.589-8 8-8 8 3.589 8 8-3.589 8-8 8z"></path><path fill="#22c55e" d="M9.999 13.587 7.7 11.292l-1.412 1.416 3.713 3.705 6.706-6.706-1.414-1.414z"></path></svg><span>'+(e.dropfile_message||"")+"</span></div>"),o.children(".file-list").addClass("d-none"),setTimeout((function(){location.reload()}),1e3)):(o.addClass("invalid-file").removeClass("file-processing"),o.children(".spinner-border").remove(),o.children(".drag-text, .drag-and-drop-file, .form-inter-bank-files").removeClass("d-none"),o.children(".file-list").addClass("d-none"),(e.toast_header||e.toast_body)&&n.displayToast("danger",e.toast_header,e.toast_body))}catch(e){console.log(e)}},error:function(e,t,n){o.addClass("fail-upload").removeClass("file-processing"),console.error("AJAX Error:",t,n)}})}}e(document).on("dragover dragleave",i,(function(t){t.preventDefault(),e(this).toggleClass("drag-over","dragover"===t.type)})),e(document).on("drop",i,(t=>{t.preventDefault();var n=t.originalEvent.dataTransfer.files[0];e(t.currentTarget).hasClass("file-uploaded")||o(n,e(t.currentTarget))})),e(document).on("change","#upload_license_key",(function(t){t.preventDefault(),o(t.target.files[0],e(this).parents(".dropzone"))}))},deactivate:function(){e("#flexify_checkout_deactive_license").on("click",(function(i){if(i.preventDefault(),!confirm(flexify_checkout_params.i18n.confirm_deactivate_license))return;let o=e(this),s=n.keepButtonState(o);e.ajax({url:t.ajax_url,type:"POST",data:{action:"flexify_checkout_deactive_license"},beforeSend:function(){o.prop("disabled",!0).html('<span class="spinner-border spinner-border-sm"></span>')},success:function(e){try{"success"===e.status?(o.prop("disabled",!0).html(s.html),n.displayToast("success",e.toast_header_title,e.toast_body_title),setTimeout((function(){location.reload()}),1e3)):n.displayToast("error",e.toast_header_title,e.toast_body_title)}catch(e){console.log(e)}},error:function(){o.prop("disabled",!1).html(s.html)}})}))},sync:function(){e(document).on("click","#flexify_checkout_sync_license",(function(i){i.preventDefault();let o=e(this),s=n.keepButtonState(o);e.ajax({url:t.ajax_url,type:"POST",data:{action:"flexify_checkout_sync_license"},beforeSend:function(){o.prop("disabled",!0).html('<span class="spinner-border spinner-border-sm"></span>'),e(".license-details-item").each((function(){e(this).addClass("placeholder-content")}))},success:function(t){try{"success"===t.status?(n.displayToast("success",t.toast_header_title,t.toast_body_title),t.license&&(e("#fcw-license-status").html(t.license.status_html),e("#fcw-license-features").html(t.license.features_html),e("#fcw-license-type").html(t.license.type_html),e("#fcw-license-expiry").html(t.license.expire_html))):n.displayToast("error",t.toast_header_title,t.toast_body_title)}catch(e){console.log(e)}},complete:function(){o.prop("disabled",!1).html(s.html),e(".license-details-item").removeClass("placeholder-content")},error:function(e,t,n){console.error("AJAX Error:",t,n)}})}))},init:function(){this.activate(),this.preLicenseActions(),this.altLicenseUpload(),this.deactivate(),this.sync()}},integrationModules:{install:function(){e(".install-module").on("click",(function(i){i.preventDefault();let o=e(this),s=n.keepButtonState(o),a=o.data("plugin-url"),c=o.data("plugin-slug");e.ajax({type:"POST",url:t.ajax_url,data:{action:"flexify_checkout_install_modules",plugin_url:a,plugin_slug:c},beforeSend:function(){o.prop("disabled",!0).html('<span class="spinner-border spinner-border-sm"></span>')},success:function(e){"success"===e.status?(o.prop("disabled",!1).html(s.html),n.displayToast("success",e.toast_header_title,e.toast_body_title),setTimeout((function(){location.reload()}),500)):n.displayToast("error",e.toast_header_title,e.toast_body_title)},error:function(e){o.prop("disabled",!1).html(s.html),alert("Error installing the plugin: "+e.responseText)}})}))},activation:function(){e(".activate-plugin").on("click",(function(i){i.preventDefault();let o=e(this),s=n.keepButtonState(o),a=o.data("plugin-slug");e.ajax({type:"POST",url:t.ajax_url,data:{action:"flexify_checkout_activate_plugin",plugin_slug:a},beforeSend:function(){o.prop("disabled",!0).html('<span class="spinner-border spinner-border-sm"></span>')},success:function(e){"success"===e.status?(o.prop("disabled",!1).html(s.html),n.displayToast("success",e.toast_header_title,e.toast_body_title),setTimeout((function(){location.reload()}),500)):n.displayToast("error",e.toast_header_title,e.toast_body_title)},error:function(){o.prop("disabled",!1).html(s.html),alert("Erro ao ativar o plugin.")}})}))},init:function(){this.install(),this.activation()}},connectionListener:{toast:function(){navigator.onLine?e(".toast.toast-offline-connection").remove():n.displayToast("warning",t.i18n.offline_toast_header,t.i18n.offline_toast_body,"toast-offline-connection")},listener:function(){window.addEventListener("online",n.connectionListener.toast),window.addEventListener("offline",n.connectionListener.toast)},init:function(){this.listener(),n.connectionListener.toast()}},codeEditor:function(){const t=window.flexify_checkout_code_editor_settings||{};e(".flexify-checkout-code-editor").each((function(){const n=this,i=e(n),o=(i.data("editor-mode")||"css").toString(),s=e.extend(!0,{},t[o]||{});s.codemirror=s.codemirror||{},s.codemirror.mode="javascript"===o?"javascript":"css",s.codemirror.indentUnit=s.codemirror.indentUnit||2,s.codemirror.tabSize=s.codemirror.tabSize||2,s.codemirror.lineNumbers=!0;const a=wp.codeEditor.initialize(n,s);a&&a.codemirror&&a.codemirror.on("change",(function(e){n.value=e.getValue(),i.trigger("change")}))}))},init:function(){this.initTabs(),this.saveOptions(),this.setupVisibilityControllers(),this.enforceMinOne(),this.filterDesignParameters(),this.mediaSelectors(),this.popups(),this.colorHelpers(),this.datepicker(),this.fieldsManager(),this.resetSettings(),this.themeSelector(),this.handleConditions(),this.fontsManager.init(),this.License.init(),this.integrationModules.init(),this.connectionListener.init(),this.codeEditor()}};e(document).ready((function(){n.init()})),window.Flexify_Checkout_Admin=n,e(document).trigger("flexify_checkout_admin_ready")}(jQuery);