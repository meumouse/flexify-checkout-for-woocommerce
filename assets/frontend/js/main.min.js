!function(e){"use strict";const t=window.flexify_checkout_params||{},o={Validations:{onChange:function(){var e=document.querySelectorAll(".form-row input, .form-row select, .form-row textarea");Array.from(e).forEach((function(e){e.addEventListener("change input",(function(t){return t.preventDefault(),o.Validations.getFieldErrors(e),!1}))}))},isValidEmail:function(e){return e.match(/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/)},getFieldErrors:async function(n){var i=n.closest(".form-row");if(!i||!i.attributes["data-label"]||!i.attributes["data-type"])return!1;var r=i.attributes["data-type"].value,s=document.getElementById("billing_country");try{if(["country","postcode","phone","email","text"].includes(r)){const a=(await new Promise(((a,c)=>{e.ajax({type:"POST",url:t.ajax_url,data:{action:"flexify_check_for_inline_error",args:{label:i.attributes["data-label"].value,required:i.classList.contains("required"),type:r},country:s?s.value:"",key:n.attributes.name.value,value:o.Helpers.getFieldValue(n)},success:function(e){a(e)},error:function(e,t,o){c(o)}})}))).data,c=a.input_id.replace("billing_","");if(e(".flexify-review-customer__content").find(".customer-details-info."+c).text(a.input_value),i.querySelector(".error").innerHTML=a.message,i.classList.remove("woocommerce-invalid"),i.classList.contains("validate-required")&&e(n).trigger("validate"),a.isCustom&&i.classList.add("woocommerce-invalid"),"info"===a.messageType){i.querySelector(".info")||i.insertAdjacentHTML("beforeend",'<span class="info" style="display:none"></span>');e(i).find(".info").html(a.message).slideDown(),"yes"===t.auto_display_login_modal&&o.loginForm.openModal(!0)}else e(i).find(".info").slideUp()}else i.classList.contains("validate-required")&&e(n).trigger("validate")}catch(e){console.error("[FLEXIFY CHECKOUT] Error validating field:",e)}const a=i.classList.contains("woocommerce-invalid");return a&&o.Steps.disableNextSteppers(i.getAttribute("data-step")),o.Validations.accessibleErrors(),a},clearErrorMessages:function(t){e(".woocommerce-notices-wrapper > div, .woocommerce-notices-wrapper ul").each((function(){t?e(this).attr(t)&&e(this).remove():e(this).remove()})),e(".woocommerce-NoticeGroup").remove()},scrollToError:function(){let e=document.querySelectorAll(".woocommerce-invalid")[0];e&&e.scrollIntoView({behavior:"smooth"})},accessibleErrors:function(){let e=document.querySelectorAll(".form-row input, .form-row select, .form-row textarea");Array.from(e).forEach((function(e){const t=e.closest(".form-row");if(!t)return;const o=t.querySelector(".error");o&&(o.setAttribute("aria-hidden","true"),o.setAttribute("aria-live","off")),t.classList.contains("woocommerce-invalid")&&(e.setAttribute("aria-invalid","true"),o&&(o.setAttribute("aria-hidden","false"),o.setAttribute("aria-live","polite")))}))},isHiddenConditionalField:function(t){const o=e(t).closest(".form-row");return o.is(":hidden")&&o.hasClass("wooccm-conditional-child")||o.hasClass("temp-hidden")},displayGlobalNotices:function(e,t,o,n){t||(t="error"),o||(o="list");var i=document.querySelector(".woocommerce-notices-wrapper");if(i){var r=document.createElement("div"),s="woocommerce-error";if("error"!==t&&(s="woocommerce-message"),"info"===t&&(s="woocommerce-info"),"object"!=typeof n||Array.isArray(n)||null===n||Object.entries(n).forEach((function(e){var t=e[0],o=e[1];r.setAttribute(t,o)})),"list"===o){r.classList.add("woocommerce-NoticeGroup"),r.classList.add("woocommerce-NoticeGroup-checkout");var a=document.createElement("ul");a.setAttribute("role","alert"),a.classList.add(s);var c=document.createElement("li");c.innerHTML=e,a.append(c),r.append(a)}else r.setAttribute("role","alert"),r.classList.add(s),r.innerHTML=e;i.append(r)}},validateSearchForm:function(){var e=document.querySelectorAll("#billing_address_search");Array.from(e).forEach((function(e){var n=e.closest(".woocommerce-billing-fields__wrapper").querySelector(".woocommerce-billing-fields");if("none"===window.getComputedStyle(n).display){o.Validations.displayGlobalNotices(t.i18n.errorAddressSearch),Array.from(e.closest(".form-row").querySelectorAll(".error")).forEach((function(e){e.remove()}));var i=e.closest(".form-row");i.classList.add("woocommerce-invalid");var r=document.createElement("span");r.setAttribute("aria-hidden","false"),r.setAttribute("aria-live","polite"),r.classList.add("error"),r.innerHTML=t.i18n.errorAddressSearch,i.append(r)}}))},checkFieldsForErrors:async function(n){const i={},r=[];n.forEach((t=>{if(!t)return;const n=t.closest(".form-row");n&&t.name&&n.dataset.label&&n.dataset.type&&(i[t.name]={args:{label:n.dataset.label,required:n.classList.contains("required"),type:n.dataset.type},country:e("#billing_country").val()||"",key:t.name,value:o.Helpers.getFieldValue(t)})}));try{const n=(await new Promise(((o,n)=>{e.ajax({type:"POST",url:t.ajax_url,data:{action:"flexify_check_for_inline_errors",fields:i,email:e("#billing_email").val()},success:function(e){o(e)},error:function(e,t,o){n(o)}})}))).data;Object.entries(n).forEach((([t,n])=>{const i=document.querySelector(`[name="${t}"]`);if(!i||o.Validations.isHiddenConditionalField(i))return;e(".flexify-review-customer__content").find(".customer-details-info."+n.input_id.replace("billing_","")).text(n.input_value);const s=i.closest(".form-row");s.querySelector(".error").innerHTML=n.message,s.classList.remove("woocommerce-invalid"),s.classList.contains("validate-required")&&e(i).trigger("validate").trigger("flexify_validate"),n.isCustom&&s.classList.add("woocommerce-invalid"),s.classList.contains("woocommerce-invalid")&&r.push(t)})),o.Components.updateFragments(n.fragments)}catch(e){console.error("[FLEXIFY CHECKOUT] AJAX error on check field errors:",e)}if(o.Validations.clearErrorMessages("data-flexify-error"),o.Validations.accessibleErrors(),r.length){const e=n[0].closest("[data-step]").dataset.step;document.querySelector(`[data-stepper-li="${e}"]`).classList.add("error"),o.Steps.disableNextSteppers(+e),o.Validations.scrollToError(),o.Validations.validateSearchForm(),o.Shippings.maybeShowShippingForm(r)}return!!r.length&&r},addMaskOnFields:function(){if("yes"!==t.enable_field_masks)return;const o=t.get_input_masks||{};e.each(o,(function(o,n){const i=e("#"+o);0!==i.length&&(i.data("mask-applied")||("function"==typeof i.unmask&&i.unmask(),"function"==typeof i.mask&&(i.mask(n),i.data("mask-applied",!0)),"yes"===t.international_phone&&"billing_phone"===o&&(i.unmask(),i.removeData("mask-applied"))))}))},validateInternationalPhone:function(o){const n=e(this),i=n.val().trim(),r=n.closest(".form-row"),s=n.data("itiInstance");!r.hasClass("has-changed")&&i.length<4?r.removeClass("woocommerce-validated woocommerce-invalid"):s&&s.promise&&s.promise.then((()=>{s.isValidNumber()?r.removeClass("woocommerce-invalid woocommerce-invalid-phone"):r.removeClass("woocommerce-validated").addClass("woocommerce-invalid woocommerce-invalid-phone").find(".error").text(t.i18n.phone.invalid)}))},markInternationalPhoneChanged:function(t){e(this).val().trim()&&e(this).closest(".form-row").addClass("has-changed")},init:function(){this.onChange();let t=e("#billing_email").val();t&&o.Validations.isValidEmail(t)&&o.Validations.getFieldErrors(document.getElementById("billing_email")),o.Validations.addMaskOnFields()}},Sidebar:{addQuantityControls:function(){var t=document.querySelectorAll('.quantity input[type="number"]');Array.from(t).forEach((function(t){var o=t.closest(".quantity");if(0<e(o).find(".quantity__button").length)return;let n=document.createElement("button");n.setAttribute("type","button"),n.classList.add("quantity__button"),n.classList.add("quantity__button--minus"),n.innerHTML="-",o.prepend(n),n.addEventListener("click",(function(){t.value=parseInt(t.value)-1,t.dispatchEvent(new Event("change"))}));let i=document.createElement("button");i.setAttribute("type","button"),i.classList.add("quantity__button"),i.classList.add("quantity__button--plus"),i.innerHTML="+",o.appendChild(i),i.addEventListener("click",(function(){t.value=parseInt(t.value)+1,t.dispatchEvent(new Event("change"))})),t.addEventListener("change",(async function(t){return t.preventDefault(),e("body").trigger("update_checkout"),!1}))})),e('.quantity input[type="number"]').on("focusin",(function(){e(this).closest(".quantity").addClass("quantity--on-focus")})),e('.quantity input[type="number"]').on("focusout",(function(){e(this).closest(".quantity").removeClass("quantity--on-focus")}))},moveShippingRow:function(){if(o.Helpers.isModernCheckout()){e(".woocommerce-checkout-review-order-table .woocommerce-shipping-totals").length&&e(".flexify-checkout__shipping-table tbody").html("");var t=e(".flexify-checkout__content-right tr.woocommerce-shipping-totals.shipping");t.length&&e(".flexify-step--address .flexify-checkout__shipping-table > tbody").html(t)}},updateCartCount:function(){var t=0;e(".quantity input.qty").each((function(){t+=parseInt(e(this).val(),10)}));const o=e(".order_review_heading__count");o.length&&o.html(t)},updateSidebarTotal:function(){const t=e(".order-total td:last-of-type").html();e(".flexify-checkout__sidebar-header-total").html(t)},autoToggleOrderSummary:function(){var e=document.querySelector(".flexify-checkout__sidebar-header");e&&e.click()},orderSummaryToggle:function(e){if(o.Helpers.isMobile()){var t=document.querySelector(".flexify-checkout__sidebar-header-link--hide"),n=document.querySelector(".flexify-checkout__sidebar-header-link--show"),i=document.querySelector(".flexify-checkout__order-review");if(o.Helpers.isModernCheckout()&&(i=document.querySelector(".flexify-checkout__content-right")),t&&i)"none"===window.getComputedStyle(t).display?(t.style.display="block",n.style.display="none",!0===e?i.style.display="block":o.UI.slideDown(i),o.UI.slideDown(i)):(t.style.display="none",n.style.display="block",!0===e?i.style.display="none":o.UI.slideUp(i))}},orderSummaryResize:function(){var t=e(".flexify-checkout__order-review");o.Helpers.isModernCheckout()&&(t=e(".flexify-checkout__content-right")),o.Helpers.isMobile()||!t.is(":hidden")||t.show()},init:function(){this.addQuantityControls(),this.moveShippingRow();var n=document.querySelector(".flexify-checkout__sidebar-header");let i;n&&n.addEventListener("click",o.Sidebar.orderSummaryToggle),e(window).on("resize",o.Sidebar.orderSummaryResize),"yes"===t.opened_default_order_summary&&(o.Sidebar.orderSummaryToggle(!0),o.Sidebar.autoToggleOrderSummary()),e(window).on("resize",(function(){clearTimeout(i),i=setTimeout(o.Sidebar.moveShippingRow,250)}))}},processCheckout:{cache:{button_html:""},onClick:function(){e(document).on("click","#place_order",(function(n){n.preventDefault(),o.Animations.preparePlaceOrderButton(),e("#place_order").addClass("flexify-checkout-btn-loading"),"yes"===t.enable_animation_process_purchase&&o.Animations.purchaseAnimation.start(),e("#place_order").closest("form").submit()}))},onSelectPaymentMethod:function(){e(document.body).on("payment_method_selected",(function(){let t=o.processCheckout.cache.button_html;t&&"paypal"!==e("[name='payment_method']:checked").val()&&e("#place_order").html(t)}))},onPlaceOrder:function(){e("form.checkout").on("checkout_place_order",(function(){o.Conditions.checkFieldVisibility()}))},onSubmitCheckoutForm:function(){e("form.checkout").submit((function(){o.Conditions.checkFieldVisibility()}))},init:function(){e("#payment_method_stripe").length||(this.onClick(),this.onSelectPaymentMethod(),this.onPlaceOrder(),this.onSubmitCheckoutForm())}},Triggers:{onUpdatedCheckout:function(){e(document.body).on("updated_checkout",(function(n,i){i.fragments.flexify.total&&(o.processCheckout.cache.button_html=`${t.i18n.pay} ${i.fragments.flexify.total}`,e("#place_order").html(o.processCheckout.cache.button_html)),i?.fragments&&o.Components.updateFragments(i),o.Helpers.isModernCheckout()&&o.Shippings.addShippingRowOnSummary(i),i?.fragments?.flexify?.global_error&&o.Validations.displayGlobalNotices(i.fragments.flexify.global_error),i?.fragments?.flexify?.empty_cart&&(e(".flexify-checkout").append(i.fragments.flexify.empty_cart),setTimeout((()=>{window.location=t.shop_page}),3e3)),o.Shippings.selectShippingMethod(),o.Helpers.removeDomElements(),o.Sidebar.init(),o.Sidebar.updateSidebarTotal()}))},onCheckoutError:function(){e(document.body).on("checkout_error",(function(n,i){e("#place_order").removeClass("flexify-checkout-btn-loading"),o.Helpers.removeDomElements(),o.Components.addNotice(i),o.Animations.purchaseAnimation.stop(),t.debug_mode&&console.log("[FLEXIFY CHECKOUT] - Checkout error: ",i)}))},onFragmentsUpdated:function(){e(document.body).on("wc_fragments_refreshed",(function(){o.Helpers.removeDomElements(),o.Sidebar.init(),o.Sidebar.updateSidebarTotal()}))},onSelectShippingMethod:function(){e(document).on("click",".shipping-method-item",(function(t){e(t.target).is("input")||e(t.target).is("label")||(o.Shippings.selectShippingMethod(),e(this).find('input[type="radio"]').prop("checked",!0).trigger("change"))})),e(document).on("change","input.shipping_method",(function(){o.Shippings.selectShippingMethod()})),e(document.body).on("change","input.shipping_method",(function(){o.Shippings.selectShippingMethod(),o.Sidebar.updateSidebarTotal()}))},removeProductItem:function(){e(document).on("click",".flexify-remove-item",(function(n){n.preventDefault();const i=e(this),r=i.closest(".cart_item"),s=i.data("product_id"),a=i.data("cart_item_key");a&&e.ajax({url:t.ajax_url,method:"POST",data:{action:"flexify_checkout_remove_product",product_id:s,cart_item_key:a,nonce:t.nonces.remove_product},beforeSend:function(){o.UI.togglePlaceholder(r,!0),i.prop("disabled",!0)},success:function(t){t.success?(r.fadeOut(300,(function(){e(this).remove()})),t.data.notice_html&&o.Components.addNotice(t.data.notice_html),e(document.body).trigger("update_checkout")):console.warn(t.data?.message||"Error on remove product.")},error:function(e,t,o){console.error("[FLEXIFY CHECKOUT] AJAX error on try remove product item:",t,o)},complete:function(){o.UI.togglePlaceholder(r,!1),i.prop("disabled",!1)}})}))},undoRemoveProduct:function(){e(document).on("click",".undo-remove-product",(function(o){o.preventDefault();const n=e(this),i=n.data("product_id");n.closest(".flexify-checkout-notice").fadeOut(300,(function(){e(this).remove()})),e.ajax({url:t.ajax_url,method:"POST",data:{action:"flexify_checkout_undo_remove_product",product_id:i,nonce:t.nonces.undo_remove_product},beforeSend:function(){e(".woocommerce-checkout-review-order-table").block({message:null,overlayCSS:{background:"#fff",opacity:.6}})},success:function(t){t.success&&(e(".woocommerce-checkout-review-order-table").unblock(),e(document.body).trigger("update_checkout"))},error:function(e,t,o){console.error("[FLEXIFY CHECKOUT] AJAX error on try undo remove product item:",t,o)}})}))},init:function(){o.Helpers.removeDomElements(),this.onUpdatedCheckout(),this.onCheckoutError(),this.onFragmentsUpdated(),this.onSelectShippingMethod(),this.removeProductItem(),this.undoRemoveProduct(),e(document.body).trigger("country_to_state_changed")}},Coupons:{onClick:function(){var e=document.querySelectorAll("[data-show-coupon]");Array.from(e).forEach((function(e){e.setAttribute("type","button"),e.addEventListener("click",(function(e){e.preventDefault();var t=e.target.closest(".woocommerce-form-coupon__wrapper").querySelector(".woocommerce-form-coupon");return"none"===t.style.display?o.UI.slideDown(t):o.UI.slideUp(t),!1}))}))},onChange:function(){e(document).on("keyup","#coupon_code",(function(){const t=e(this).closest(".checkout_coupon").find(".flexify-coupon-button");e(this).val().trim()?t.removeClass("flexify-coupon-button--disabled"):t.addClass("flexify-coupon-button--disabled")}))},applyCoupon:function(){e(document).on("click","button[name=apply_coupon]",(function(t){t.preventDefault();let n=e(this),i=o.Helpers.keepButtonState(n);const r=n.closest(".woocommerce-form-coupon__wrapper");e(".woocommerce-form-coupon__wrapper").find(".error, .success").remove(),e.ajax({type:"POST",url:wc_checkout_params.wc_ajax_url.toString().replace("%%endpoint%%","apply_coupon"),data:{action:"apply_coupon",coupon_code:r.find('input[name="coupon_code"]').val(),security:wc_checkout_params.apply_coupon_nonce},contentType:"application/x-www-form-urlencoded; charset=UTF-8",dataType:"html",beforeSend:function(){n.prop("disabled",!0).html('<span class="flexify-btn-processing-inline"></span>')},success:function(t){const o=e("<div>").html(t);let n="",i="success";o.find(".woocommerce-error li").length?(n=o.find(".woocommerce-error li").text().trim(),i="error"):o.find(".woocommerce-message li").length&&(n=o.find(".woocommerce-message li").text().trim(),i="success"),e(document.body).trigger("update_checkout"),e(document.body).one("updated_checkout",(function(){n&&e(".woocommerce-form-coupon__inner").append(`<div class="flexify-coupon-notice ${i}" aria-hidden="false" aria-live="polite">${n}</div>`)}))},error:function(e,t,o){console.error("[FLEXIFY CHECKOUT] AJAX error on applying coupon:",t,o)},complete:function(){n.html(i.html).prop("disabled",!1),o.Components.removeSpinner(n)}})}))},removeCoupon:function(){e(document.body).off("click",".woocommerce-remove-coupon"),e(document.body).on("click",".woocommerce-remove-coupon",(function(o){o.preventDefault();let n=e(this).data("coupon");e.ajax({type:"POST",url:wc_checkout_params.wc_ajax_url.toString().replace("%%endpoint%%","remove_coupon"),data:{security:wc_checkout_params.remove_coupon_nonce,coupon:n},dataType:"html",success:function(o){e(".woocommerce-error, .woocommerce-message").remove(),e(".woocommerce-form-coupon__wrapper").find(".error, .success").remove(),o&&(e(document.body).trigger("removed_coupon_in_checkout",[n]),e(document.body).trigger("update_checkout"),e(document.body).one("updated_checkout",(function(){e(".woocommerce-form-coupon__inner .form-row-first").append(`<div class="success" aria-hidden="false" aria-live="polite">${t.i18n.coupon_success}</div>`)})),e("form.checkout_coupon").find('input[name="coupon_code"]').val(""))},error:function(e,t,o){console.error("[FLEXIFY CHECKOUT] AJAX error on remove coupon:",t,o)}})}))},init:function(){this.onClick(),this.applyCoupon(),this.onChange(),this.removeCoupon(),e(".flexify-checkout--has-sidebar")[0]&&(e(document.body).on("wc_fragments_refreshed",(function(){o.Coupons.onClick()})),e(document.body).on("updated_checkout",(function(){o.Coupons.onClick()})),e(document).on("keydown","#coupon_code",(function(t){"Enter"!==t.key&&13!==t.keyCode||(e("[name=apply_coupon]").trigger("click"),t.preventDefault())})),setTimeout(o.Coupons.removeCoupon,100))}},Helpers:{keepButtonState:function(e){var t=e.width(),o=e.height(),n=e.html();return e.width(t),e.height(o),{width:t,height:o,html:n}},isModernCheckout:function(){return document.querySelectorAll(".flexify-checkout--modern").length},isMobile:function(){return e(window).width()<1024},getFieldValue:function(e){return e.value},setCookie:function(e,t,o){let n="";if(o){let e=new Date;e.setTime(e.getTime()+24*o*60*60*1e3),n="; expires="+e.toUTCString()}document.cookie=e+"="+encodeURIComponent(t)+n+"; path=/"},getCookie:function(e){let t=document.cookie.match(new RegExp("(?:^|; )"+e.replace(/([\.\$?*|{}\(\)\[\]\/+^])/g,"\\$1")+"=([^;]*)"));return t?decodeURIComponent(t[1]):void 0},deleteCookie:function(e){document.cookie=e+"=; Max-Age=0; path=/; domain="+window.location.hostname},removeDomElements:function(){const t=document.querySelector(".woocommerce-form-login-toggle"),n=document.querySelector(".shopkeeper_checkout_login");t&&t.remove(),n&&n.remove();const i=e(".flexify-checkout__steps .woocommerce-notices-wrapper");i.length>1&&i.slice(1).remove(),o.Helpers.repositionNotices()},repositionNotices:function(){const t=o.Helpers.isModernCheckout(),n=document.querySelector("form.woocommerce-checkout > .woocommerce-NoticeGroup.woocommerce-NoticeGroup-checkout"),i=e(".woocommerce-notices-wrapper");if(t&&n){var r=n.querySelector(".woocommerce-error");if(!r)return;i.append(r),n.remove()}t&&i&&i.prependTo(".flexify-checkout__steps")}},localStorage:{loadData:function(){const e=localStorage.getItem("flexify_checkout_form_data"),o=document.querySelector("form.checkout");if(!e||!o)return;let n;try{n=JSON.parse(e)}catch{return}const i=t.localstorage_fields||[];Object.entries(n).forEach((([e,t])=>{if(!i.includes(e))return;const n=o.elements[e];if(n&&null!=t&&("string"==typeof t||"number"==typeof t)){if("checkbox"===n.type)n.checked="on"===t;else if("SELECT"===n.tagName)[...n.options].some((e=>e.value===String(t)))&&(n.value=String(t));else if("radio"===n.type){o.querySelectorAll(`input[name="${CSS.escape(e)}"][type="radio"]`).forEach((e=>e.checked=e.value===String(t)))}else n.value=String(t);n.dispatchEvent(new Event("change",{bubbles:!0}))}}))},onChange:function(e){const o=e.target.closest("form.checkout");if(!o)return;const n={},i=t.localstorage_fields||[];Array.from(o.elements).forEach((e=>{if(!e.name||!i.includes(e.name))return;let t;if("checkbox"===e.type)t=e.checked?"on":"";else if("radio"===e.type){if(!e.checked)return;t=e.value}else t=e.value;null==t||"string"!=typeof t&&"number"!=typeof t||(n[e.name]=String(t))})),localStorage.setItem("flexify_checkout_form_data",JSON.stringify(n))},init:function(){const e=document.querySelector("form.checkout");e&&(e.addEventListener("change",this.onChange.bind(this)),this.loadData())}},loginForm:{showNotice:function(t,o){o||(o="error");var n=e(".flexify-login-notice"),i=`flexify-login-notice--${o}`;n.removeClass("flexify-login-notice--success flexify-login-notice--error flexify-login-notice--info"),n.addClass(i),n.html(t)},openModal:function(n){let i=e("#billing_email").val();i&&e(".woocommerce-form-login #username").val(i).trigger("change"),n&&o.loginForm.showNotice(t.i18n.account_exists,"info"),window.setTimeout((function(){e(".woocommerce-form-login #password").focus().trigger("focus")}),300),e.magnificPopup.open({items:{src:".woocommerce-form-login",type:"inline"}})},onClick:function(){setTimeout((()=>{e(document.body).off("click","a.showlogin")}),100),e(document).on("click","[data-login], .showlogin",(function(e){e.preventDefault(),o.loginForm.openModal()}))},passwordVisibility:function(){e(".toggle-password-visibility .toggle").on("click",(function(){var t=e(".flexify-login-password"),o=e(".toggle-password-visibility .show-password"),n=e(".toggle-password-visibility .hide-password");"password"===t.attr("type")?(t.attr("type","text"),o.hide(),n.show()):(t.attr("type","password"),o.show(),n.hide())}))},onSubmit:function(n){n.preventDefault();const i=e(".woocommerce-form-login");let r=e(".flexify-button.woocommerce-button.button.woocommerce-form-login__submit"),s=o.Helpers.keepButtonState(r);e.ajax({type:"POST",url:t.ajax_url,data:{action:"flexify_checkout_login",username:i.find("#username").val(),password:i.find("#password").val(),remember:i.find("#rememberme").val(),_wpnonce:i.find("#woocommerce-login-nonce").val()},beforeSend:function(){r.prop("disabled",!0).html('<span class="flexify-btn-processing-inline"></span>')},success:function(e){e.success?(o.loginForm.showNotice(t.i18n.login_successful,"success"),r.prop("disabled",!0).addClass("btn-success").html('<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" style="fill:#fff"><path d="m10 15.586-3.293-3.293-1.414 1.414L10 18.414l9.707-9.707-1.414-1.414z"/></svg>'),window.location.reload()):o.loginForm.showNotice(e.data.error,"error")},error:function(e,n,i){console.error("[FLEXIFY CHECKOUT] AJAX error on try login user:",n,i),o.loginForm.showNotice(t.i18n.error,"error")},complete:function(){r.html(s.html).prop("disabled",!0)}})},init:function(){this.onClick(),this.passwordVisibility(),e(".woocommerce-form-login").hasClass("woocommerce-form-login--auto-open")&&window.setTimeout((function(){o.loginForm.openModal()}),1e3),e(".woocommerce-form-login > h2:first").append('<div class="flexify-login-notice"></div>'),e(".woocommerce-form-login").on("submit",o.loginForm.onSubmit)}},Animations:{preparePlaceOrderButton:function(){if(e("#place_order").find(".flexify-submit-dots").length)return;let t=e("#place_order").html();e("#place_order").html(t+'<span class="flexify-submit-dots">\n                    <i class="flexify-submit-dot flexify-submit-dot__1"></i>\n                    <i class="flexify-submit-dot flexify-submit-dot__1"></i>\n                    <i class="flexify-submit-dot flexify-submit-dot__1"></i>\n                </span>')},purchaseAnimation:function(){let t=1;let o,n,i=0,r=!1;const s=function(){const n=e("#flexify_checkout_purchase_animation");clearInterval(o),o=setInterval((()=>{n.find(".purchase-animation-item").removeClass("active");const e=n.find(`.purchase-animation-item.animation-${t}`);e.addClass("active");const o=e.find("lord-icon")[0];o&&o.playerInstance&&o.playerInstance.playFromBeginning(),t=t%3+1}),2e3)},a=function(e){const t=Math.floor(11*Math.random())+15;i+=t,i>95&&(i=95,clearInterval(n)),e.css("width",`${i}%`)},c=function(){t=1,i=0,clearInterval(o),clearInterval(n)};return{start:function(){const t=e("#flexify_checkout_purchase_animation"),o=t.find(".animation-progress-bar");r||(r=!0,c(),o.css("width","0%"),t.addClass("active"),setTimeout((()=>{e(".woocommerce-checkout.processing").find(".blockOverlay").css("display","none")}),10),s(),n=setInterval((()=>{a(o)}),1200))},stop:function(){const t=e("#flexify_checkout_purchase_animation"),s=t.find(".animation-progress-bar");clearInterval(o),clearInterval(n),r=!1,i=0,s.css("width","0%"),t.find(".purchase-animation-item").removeClass("active"),t.removeClass("active")}}}()},Steps:{steps_hash:t.steps,getFields:function(t){var o=e(t),n=o.find(".create-account input, .create-account select, .create-account textarea"),i=o.find(".woocommerce-shipping-fields input, .woocommerce-shipping-fields select, .woocommerce-shipping-fields textarea"),r=o.find(".woocommerce-additional-fields input, .woocommerce-additional-fields select, .woocommerce-additional-fields textarea"),s=[];return o.find("input, select, textarea").each((function(){var t=e(this);(o.find("input[name=createaccount]:checked").length||o.find(".create-account").filter((function(){return"block"===e(this).css("display")})).length||!n.is(t))&&(!o.find("input[name=ship_to_different_address]:checked").length&&i.is(t)||!o.find("input[name=show_additional_fields]:checked").length&&r.is(t)||"billing_phone_full_number"!==t.attr("name")&&s.push(this))})),s},onStepperClick:function(){e("[data-stepper]").each((function(){e(this).on("click",(async function(t){t.preventDefault(),o.Validations.clearErrorMessages();let n=e(this).data("stepper");if(e(this).closest("[data-stepper-li]").hasClass("selected"))return!1;let i=!1;if(n>1){let t=o.Steps.getFields(e(`[data-step="${n-1}"]`));i=await o.Validations.checkFieldsForErrors(t),i&&console.log("[FLEXIFY CHECKOUT] Field errors: ",i)}return i||(window.location.hash="#"+o.Steps.steps_hash[n],e(document.body).trigger("country_to_state_changed")),!1}))}))},onNextClick:function(){e("[data-step-next]").each((function(){e(this).on("click",(async function(t){t.preventDefault();let n=e(this);o.Components.addSpinner(n),o.Validations.clearErrorMessages();let i=n.closest("[data-step]"),r=o.Steps.getFields(i);if(await o.Validations.checkFieldsForErrors(r)){o.Components.removeSpinner(n),o.Validations.scrollToError();let e=Number(i.attr("data-step"));return o.Steps.disableNextSteppers(e),!1}o.Components.removeSpinner(n);let s=n.data("step-show");return!!e(`[data-step="${s}"]`).length&&(window.location.hash="#"+o.Steps.steps_hash[s],e(document.body).trigger("country_to_state_changed"),!1)}))}))},switchStepper:function(t,n){const i=e(`[data-stepper-li="${t}"]`),r=e(`[data-stepper-li="${n}"]`);i.removeClass("error disabled selected"),i.find("button").removeAttr("disabled aria-disabled"),r.removeClass("error disabled").addClass("selected"),r.find("button").removeAttr("disabled aria-disabled"),o.Steps.completePreviousSteppers(n)},disableNextSteppers:function(t){e("[data-stepper-li]").each((function(){var o=e(this),n=o.data("stepper-li");t===n&&o.removeClass("complete"),t>=n||(o.addClass("disabled").removeClass("complete"),o.find("[data-stepper]").attr({disabled:"disabled","aria-disabled":"true"}))}))},completePreviousSteppers:function(t){e("[data-stepper-li]").each((function(){var o=e(this);o.data("stepper-li")>=t||o.addClass("complete")}))},switchPanels:function(t,o){let n=e(`[data-step="${t}"]`),i=e(`[data-step="${o}"]`);n.css("display","none").attr("aria-hidden","true"),i.css("display","").attr("aria-hidden","false"),e(window).scrollTop(0)},onHashChange:function(t){if(window.location.hash){var n,i,r,s,a;n=window.location.hash.replace("#",""),a=o.Steps.isHashGoingForward(t),n.includes("|")?(r=(i=n.split("|"))[0],s=i[1]):r=n;var c=document.querySelector('[data-hash="'+r+'"]');if(c){var l=c.attributes["data-stepper"].value,d=document.querySelector(".flexify-stepper__step.selected .flexify-stepper__button"),u=d.attributes["data-stepper"].value,p=d.attributes["data-stepper"].value,f=l===u;if(a&&o.Validations.clearErrorMessages(),f)return o.Steps.scrollToElement(s),!1;o.Steps.switchPanels(p,l),o.Steps.switchStepper(p,l),o.Steps.scrollToElement(s),e(document.body).trigger("country_to_state_changed"),e(document.body).trigger("flexify_step_change"),document.getElementById("billing_phone")&&document.getElementById("billing_phone").dispatchEvent(new Event("keyup"))}}},handeStepOnPageLoad:function(){window.location.hash?o.Steps.onHashChange():window.location.hash=o.Steps.steps_hash[1]},findHashIndex:function(e){for(var t in e=e.replace("#",""),this.steps_hash)if(this.steps_hash[t]===e)return t;return!1},isHashGoingForward:function(e){if(!e)return!1;let t=new URL(e.newURL),n=new URL(e.oldURL),i=o.Steps.findHashIndex(t.hash),r=o.Steps.findHashIndex(n.hash);return parseInt(i)>parseInt(r)},scrollToElement:function(t){t&&e(`#${t}`).length&&e("html, body").animate({scrollTop:e(`#${t}`).offset().top-60},"fast")},init:function(){this.handeStepOnPageLoad(),this.onNextClick(),this.onStepperClick(),window.addEventListener("hashchange",o.Steps.onHashChange)}},Fields:{updateInternationalPhoneHiddenField:function(t){let o=e('input[name="billing_phone_full_number"]');o.length||e("#billing_phone").after('<input type="hidden" name="billing_phone_full_number">'),o.val(t)},internationalPhone:function(){const n=e('.flexify-intl-phone input[type="tel"], .flexify-intl-phone input[type="text"]');n.length&&n.each(((n,i)=>{const r=e(i),s=window.intlTelInput(i,{loadUtils:()=>import(t.path_to_utils),autoPlaceholder:"polite",containerClass:"flexify-intl-phone--init",nationalMode:!0,separateDialCode:!0,initialCountry:t.base_country||"br",onlyCountries:t.allowed_countries||["br"],i18n:t.i18n.iti_i18n||{}});r.data("itiInstance",s),r.closest(".form-row").addClass("flexify-intl-phone--init"),s.promise.then((()=>{i.addEventListener("countrychange",(()=>{o.Fields.updateInternationalPhoneHiddenField(s.getNumber())})),r.on("blur",o.Validations.markInternationalPhoneChanged),r.on("blur validate flexify_validate keyup",o.Validations.validateInternationalPhone),r.on("blur validate flexify_validate keyup",(function(){o.Fields.updateInternationalPhoneHiddenField(s.getNumber())})),e("#billing_country").on("change",(function(){const t=e(this).val().toLowerCase();s.setCountry(t),e("#billing_phone").change()})),e("#billing_country").on("change",o.Validations.validateInternationalPhone)})),e("form.checkout").off("input","**")}))},hasPermanentPlaceholder:function(e){const o=e.find("label");if(!o.length)return!1;const n=o.attr("for");return!!["billing_address_info","shipping_address_info",""].includes(n)||"billing_phone"===n&&"yes"===t.international_phone},addRemoveFocusClass:function(){e(document).on("focus",".form-row input",(function(){e(this).closest(".form-row").addClass("form-row--focus")})),e(document).on("blur",".form-row input",(function(){e(this).closest(".form-row").removeClass("form-row--focus")}))},prepareFields:function(){e(".form-row").each((function(){const t=e(this),n=t.find("input, select").first(),i=o.Fields.hasPermanentPlaceholder(t),r=n.is("select")||!!n.val();t.toggleClass("is-active",i||r)}))},toggleField:function(t,o,n,i=!0){const r=e(t),s=r.closest(".form-row");r.prop("required",n),o?(s.removeClass("temp-hidden"),i&&s.addClass("validate-required required-field"),s.show()):(i&&s.removeClass("validate-required required-field"),s.addClass("temp-hidden").hide())},autoFillAddress:function(n){const i=e(`#${n}_postcode`).val().replace(/\D/g,""),r=["address_1","neighborhood","city","state"].map((e=>{const t=document.getElementById(`${n}_${e}`);return t?.closest("p.form-row")||null})).filter((e=>e));8===i.length&&e.ajax({type:"GET",url:t.fill_address.api_service.replace("{postcode}",i),dataType:"json",contentType:"application/json",beforeSend:function(){o.UI.togglePlaceholder(r,!0)},success:function(e){e&&o.Fields.fillAddressFields(n,e)},error:function(e,t,n){console.error("[FLEXIFY CHECKOUT] AJAX error on try fill address:",t,n),o.UI.togglePlaceholder(r,!1)},complete:()=>{o.UI.togglePlaceholder(r,!1)}})},fillAddressFields:function(o,n){const i=t.fill_address;e(`#${o}_address_1`).val(n[i.address_param]).change(),e(`#${o}_neighborhood`).val(n[i.neightborhood_param]).change(),e(`#${o}_city`).val(n[i.city_param]).change(),e(`#${o}_state`).val(n[i.state_param]).change()},initAutoFillAddress:function(){["billing","shipping"].forEach((t=>{const n=e(`#${t}_postcode`),i=e(`#${t}_address_1`);n.val()&&!i.val()&&o.Fields.autoFillAddress(t),n.on("keyup",(()=>{o.Fields.autoFillAddress(t)}))}))},initCnpjAutofill:function(){e("#billing_cnpj").on("blur",this.getCnpjData.bind(this))},getCnpjData:function(n){const i=e(n.target).val().replace(/\D/g,"");if(14!==i.length)return;const r=["billing_phone","billing_company","billing_postcode","billing_address_1","billing_number","billing_neighborhood","billing_city","billing_state"].map((e=>{const t=document.getElementById(e);return t?t.closest("p.form-row"):null})).filter(Boolean);e.ajax({type:"POST",url:t.ajax_url,data:{action:"cnpj_autofill_query",cnpj:i},beforeSend:function(){o.UI.togglePlaceholder(r,!0)},success:function(e){e.success&&e.data&&o.Fields.fillCnpjFields(e.data,r)},error:function(e,t,n){console.error("[FLEXIFY CHECKOUT] AJAX error on try fill CNPJ data:",t,n),o.UI.togglePlaceholder(r,!1)},complete:function(){o.UI.togglePlaceholder(r,!1)}})},fillCnpjFields:function(t,o){const n={billing_phone:"telefone",billing_company:"nome",billing_postcode:"cep",billing_address_1:"logradouro",billing_number:"numero",billing_neighborhood:"bairro",billing_city:"municipio",billing_state:"uf"};o.forEach((o=>{const i=e("input, select, textarea",o),r=i.attr("id"),s=n[r];if(!s||!t[s])return;let a=t[s];"cep"===s&&(a=a.replace(/\D/g,""),a.length>=8&&(a=a.replace(/(\d{5})(\d{3})/,"$1-$2"))),i.val(a).change()}))},toggleBrazilianMarketFields:function(){const t=e("#billing_country").val(),o=["#billing_persontype_field","#billing_cpf_field","#billing_rg_field","#billing_cnpj_field","#billing_ie_field","#billing_cellphone_field","#billing_birthdate_field","#billing_sex_field","#billing_number_field","#billing_neighborhood_field"].join(",");e(o).toggleClass("d-none","BR"!==t)},init:function(){o.Fields.prepareFields(),o.Fields.addRemoveFocusClass(),e(document).on("change focus keydown",".form-row input, .form-row select, .form-row textarea",(function(){e(this).closest(".form-row").addClass("is-active")})),e(document).on("blur",".form-row input, .form-row select, .form-row textarea",(function(){let t=e(this).closest(".form-row");o.Fields.hasPermanentPlaceholder(t)||e(this).val()||t.removeClass("is-active")})),e(document.body).on("country_to_state_changed",(function(){o.Fields.prepareFields()})),"BR"===e("#billing_country").val()&&"yes"===t.fill_address.enable_auto_fill_address&&t.license_is_valid&&o.Fields.initAutoFillAddress(),"yes"===t.enable_autofill_company_info&&t.license_is_valid&&o.Fields.initCnpjAutofill(),"yes"===t.enable_hide_brazilian_market_fields&&t.license_is_valid&&(e(document).ready(o.Fields.toggleBrazilianMarketFields.bind(this)),e("#billing_country").on("change",o.Fields.toggleBrazilianMarketFields.bind(this))),"yes"===t.international_phone&&t.license_is_valid&&o.Fields.internationalPhone()}},Components:{addSpinner:function(e){e.prop("disabled",!0).addClass("flexify-button--processing")},removeSpinner:function(e){e.prop("disabled",!1).removeClass("flexify-button--processing")},passwordStrengthMeter:function(){"yes"===t.check_password_strenght&&e("#account_password").on("keyup",(function(){let t=e(this).val(),o=e(".woocommerce-password-strength"),n=e(".create-account").find(".password-strength-meter"),i=e(".flexify-button");if(n.removeClass("short bad good strong"),""!==t){if(e(".password-meter").addClass("active"),o.length>0){let e=o.attr("class");e.includes("short")?(n.addClass("short"),i.prop("disabled",!0)):e.includes("bad")?(n.addClass("bad"),i.prop("disabled",!0)):e.includes("good")?(n.addClass("good"),i.prop("disabled",!1)):e.includes("strong")&&(n.addClass("strong"),i.prop("disabled",!1))}}else e(".password-meter").removeClass("active")}))},initSelect2Fields:function(){const o=t.get_new_select_fields||[];e(o).each((function(){"billing_country"!==this&&"shipping_country"!==this&&e("#"+this).select2()}))},updateFragments:function(t){for(var o in t)e(o).length&&e(o).replaceWith(t[o])},accountToggle:function(){e(".woocommerce-account-fields input#createaccount").unbind(),Array.from(document.querySelectorAll(".woocommerce-account-fields input#createaccount")).forEach((function(t){t.addEventListener("change",(function(t){t.preventDefault(),t.stopPropagation();let n=t.target.closest(".woocommerce-account-fields").querySelector("div.create-account");return!!n&&(t.target.checked?(o.UI.slideDown(n),n.setAttribute("aria-hidden","false")):(o.UI.slideUp(n),n.setAttribute("aria-hidden","true")),setTimeout((function(){Array.from(n.querySelectorAll("input, select, textarea")).forEach((function(e){e.closest(".form-row").classList.remove("woocommerce-invalid")}))}),1),e(document.body).trigger("country_to_state_changed"),!1)}))}))},shippingToggle:function(){Array.from(document.querySelectorAll("#ship-to-different-address input")).forEach((function(t){t.addEventListener("change",(function(t){t.preventDefault();var n=t.target.closest(".woocommerce-shipping-fields__wrapper").querySelector(".shipping_address");return t.target.checked?(o.UI.slideDown(n),n.setAttribute("aria-hidden","false")):(o.UI.slideUp(n),n.setAttribute("aria-hidden","true")),e(document.body).trigger("country_to_state_changed"),!1}))}))},orderNotesToggle:function(){Array.from(document.querySelectorAll("#show-additional-fields input")).forEach((function(t){t.addEventListener("change",(function(t){t.preventDefault();var n=t.target.closest(".woocommerce-additional-fields__wrapper").querySelector(".woocommerce-additional-fields");return t.target.checked?(o.UI.slideDown(n),n.setAttribute("aria-hidden","false")):(o.UI.slideUp(n),n.setAttribute("aria-hidden","true")),e(document.body).trigger("country_to_state_changed"),!1}))}))},onCountryChange:function(){window.setTimeout((function(){if(e("#billing_state").length){"SELECT"===e("#billing_state").prop("tag_name")?e("#billing_state").closest(".form-row").attr("data-type","select"):(e("#billing_state").closest(".form-row").attr("data-type","text"),e("#billing_state").attr("placeholder",""))}if(e("#shipping_state").length){"SELECT"===e("#shipping_state").prop("tag_name")?e("#shipping_state").closest(".form-row").attr("data-type","select"):(e("#shipping_state").closest(".form-row").attr("data-type","text"),e("#shipping_state").attr("placeholder",""))}}))},watchCountryChange:function(){e("#billing_country").length?(e("#billing_country, #shipping_country").change((function(){o.Components.onCountryChange()})),o.Components.onCountryChange()):o.Components.onCountryChange()},updateReviewData:function(){document.querySelectorAll(".form-row input, .form-row select, .form-row textarea").forEach((function(t){e(t).on("change input keyup",(function(){let o=t.id.replace("billing_","");e(".flexify-review-customer__content").find(".customer-details-info."+o).html(e(t).val())}))}))},showSuggestions:function(t,o,n){o.empty(),n.forEach((n=>{const i=e("<li>").text(t.val().split("@")[0]+"@"+n).on("click",(function(){t.val(e(this).text()).trigger("change"),o.removeClass("show"),e("button[type='submit']").prop("disabled",!1)}));o.append(i)})),o.addClass("show")},bindEmailSuggestionField:function(o){const n=o.attr("id");let i=t.get_email_providers||{},r=`#flexify_checkout_email_suggest_${n}`;0===e(r).length&&o.after(`<div class="flexify-checkout-email-suggestions" id="flexify_checkout_email_suggest_${n}"></div>`);const s=e(r),a=e("<ul>").addClass("auto-list").appendTo(s);o.on("keyup",(()=>{const e=o.val();if(e.includes("@")){const t=e.split("@")[1]||"",n=i.filter((e=>e.startsWith(t)));n.length?this.showSuggestions(o,a,n):a.removeClass("show")}else a.removeClass("show")})),o.on("blur",(()=>{setTimeout((()=>a.removeClass("show")),200)}))},relocateExpressButtons:function(){const t=e(".flexify-express-checkout-wrap");e("#wc-stripe-payment-request-wrapper>div").each((function(){e(this).appendTo(t).wrap('<div class="flexify-express-checkout__btn flexify-expresss-checkout__btn--stripe flexify-skeleton"></div>')})),e(".eh_paypal_express_link").appendTo(t).wrap('<div class="flexify-express-checkout__btn"></div>')},stripeHideEmptyElement:function(){const t=e(".flexify-express-checkout-wrap");e("#wc-stripe-payment-request-button").length&&(e(".flexify-expresss-checkout__btn--stripe").addClass("flexify-skeleton"),setTimeout((function(){e("#wc-stripe-payment-request-button div").length||e("#wc-stripe-payment-request-button").hide(),e(".flexify-expresss-checkout__btn--stripe").removeClass("flexify-skeleton"),t.find(">div,>span,>a").length<2&&0==e("#wc-stripe-payment-request-button>div").length&&t.hide()}),3e3))},addNotice:function(t){e(".woocommerce-notices-wrapper").append(t)},removeNotice:function(){e(document).on("click",".close-notice",(function(t){t.preventDefault();let o=e(this);var n=o.closest(".flexify-checkout-notice");n.length>=1?(n.addClass("removing-notice").fadeOut("fast"),setTimeout((function(){e(".flexify-checkout-notice.removing-notice").remove()}),500)):(o.parent("li").parent("ul.woocommerce-error").addClass("removing-notice").fadeOut("fast"),setTimeout((function(){e(".woocommerce-error.removing-notice").remove()}),500))}))},init:function(){this.initSelect2Fields(),this.passwordStrengthMeter(),this.accountToggle(),this.shippingToggle(),this.orderNotesToggle(),this.watchCountryChange(),this.updateReviewData(),this.relocateExpressButtons(),this.stripeHideEmptyElement(),this.removeNotice(),e("html").removeClass("no-js"),"yes"===t.enable_emails_suggestions&&e('p.form-row[data-type="email"] input').each(((t,o)=>{this.bindEmailSuggestionField(e(o))}))}},UI:{slideDown:function(e){"block"!==e.style.display&&(e.style.height=0,e.classList.add("slide-down"),e.style.display="block",e.style.height=`${e.scrollHeight}px`,setTimeout((function(){e.classList.remove("slide-down"),e.style.height=""}),500))},slideUp:function(e){"none"!==e.style.display&&(e.style.height=`${e.scrollHeight}px`,e.classList.add("slide-up"),setTimeout((function(){e.style.height=0}),10),setTimeout((function(){e.style.display="none",e.classList.remove("slide-up"),e.style.height=""}),500))},togglePlaceholder:function(t,o){e(t).each((function(){e(this).toggleClass("flexify-checkout-loading-placeholder",o)}))}},Shippings:{maybeShowShippingForm:function(t){if(e("#ship-to-different-address-checkbox").is(":checked")&&t){var o=!1;t.forEach((e=>{e.includes("shipping_")&&(o=!0)})),o&&(e(".shipping-address-search").slideUp(),e(".woocommerce-shipping-fields").slideDown())}},addShippingRowOnSummary:function(t){0===e("#flexify-checkout-summary-shipping-row").length&&e("#order_review > table > tfoot tr.cart-subtotal").after('<tr id="flexify-checkout-summary-shipping-row"></tr>');let o=t?.fragments?.flexify?.shipping_row;o&&o.length>0&&e("#flexify-checkout-summary-shipping-row").html(o)},countryChanges:function(){e("select.country_select").on("select2:open",(function(t){e(".select2-dropdown--above").length<=0||e(this).closest(".form-row").find("label").hide()})).on("select2:close",(function(t){e(this).closest(".form-row").find("label").show()}))},selectShippingMethod:function(){e(".shipping-method-item").removeClass("selected-method"),e("input.shipping_method:checked").closest(".shipping-method-item").addClass("selected-method")},init:function(){this.countryChanges()}},Payments:{changePaymentMethod:function(){e(document.body).on("change",'input[name="payment_method"]',(function(){e(document.body).trigger("update_checkout")}))},init:function(){this.changePaymentMethod()}},Session:{debounce:function(e,t){let o;return function(){const n=this,i=arguments;clearTimeout(o),o=setTimeout((()=>e.apply(n,i)),t)}},update:function(){const o=t.get_all_checkout_fields||[],n=[];e(o).each((function(t,o){o&&e.each(o,(function(t,o){let i=e("#"+t).val();void 0!==i&&n.push({field_id:t,value:i})}))})),e.ajax({type:"POST",url:t.ajax_url,data:{action:"get_checkout_session_data",fields_data:JSON.stringify(n),ship_to_different_address:e("#ship-to-different-address-checkbox").is(":checked")?"yes":"no"},error:function(e,t,o){console.error("[FLEXIFY CHECKOUT] AJAX error on try session update data:",t,o)}})},init:function(){const n=t.get_all_checkout_fields||{},i=this.debounce(this.update.bind(this),500);o.Session.update(),e.each(n,((t,o)=>{o.billing&&e.each(o.billing,(t=>{e("#"+t).on("change input",i)}))})),e(".flexify-button[data-step-next]").on("click",(function(e){e.preventDefault(),o.Session.update()}))}},Conditions:{checkCondition:function(e,t,o=""){switch(e){case"is":return t===o;case"is_not":return t!==o;case"empty":return""===t;case"not_empty":return""!==t;case"contains":return-1!==t.indexOf(o);case"not_contain":return-1===t.indexOf(o);case"start_with":return t.startsWith(o);case"finish_with":return t.endsWith(o);case"bigger_then":return parseFloat(t)>parseFloat(o);case"less_than":return parseFloat(t)<parseFloat(o);default:return!1}},checkFieldVisibility:function(){Object.values(t.field_condition||{}).forEach((t=>{const o=e("#"+t.component_field),n=o.closest(".form-row"),i=e("#"+t.verification_condition_field).val(),r=this.checkCondition(t.condition,i,t.condition_value);"show"===t.type_rule&&"field"===t.verification_condition?r?(o.prop("required",!0),n.removeClass("temp-hidden").addClass("validate-required required-field").show()):(o.prop("required",!1),n.removeClass("required-field woocommerce-invalid validate-required").addClass("temp-hidden").hide()):"hide"===t.type_rule&&(r?(o.prop("required",!1),n.removeClass("required required-field woocommerce-invalid validate-required").addClass("temp-hidden").hide()):(o.prop("required",!0),n.removeClass("temp-hidden").addClass("validate-required required-field").show()))})),e("label.has-condition.required-field > span.optional").remove(),e("label.has-condition.required-field").each((function(){e(this).find("abbr.required").length||e(this).append(`<abbr class="required" title="${t.i18n.required_field}">*</abbr>`)}))},init:function(){(t.field_condition||[]).forEach((t=>{const o="#"+t.verification_condition_field;e(document).on("change input keyup",o,(()=>{this.checkFieldVisibility(),e("form.checkout").trigger("update_checkout").trigger("wc_fragment_refresh")}))})),this.checkFieldVisibility()}},Compatibility:{compatSalesBooster:function(){Array.from(document.querySelectorAll("[data-flexify-wsb-checkout-bump-trigger]")).forEach((function(t){t.addEventListener("change",(function(){e("[data-flexify-wsb-checkout-bump-trigger]").trigger("change")}))}))},compatDeliverySlots:function(){window.setTimeout((function(){e("#jckwds-delivery-date, #jckwds-delivery-time").on("validate",(function(t){"1"===e("[name=flexify-wds-fields-hidden]").val()&&(e(t.target).closest(".form-row").removeClass("woocommerce-invalid"),t.stopPropagation())}))}))},updatePersonTypeFields:function(){const t=e("#billing_persontype");if(!t.length)return;const n=parseInt(t.val(),10);o.Fields.toggleField("#billing_cpf",1===n,!0,!0),o.Fields.toggleField("#billing_cnpj",1!==n,!1,!0),o.Fields.toggleField("#billing_ie",1!==n,!1,!0),o.Fields.toggleField("#billing_company",1!==n,2===n,!1)},initPersonTypeFields:function(){const t=this.updatePersonTypeFields.bind(this);e(document).on("change","#billing_persontype",t),t()},init:function(){this.compatSalesBooster(),this.compatDeliverySlots(),this.initPersonTypeFields(),e(window).on("pageshow",(function(){o.Fields.prepareFields()})),e(".address-field input.input-text").on("input propertychange paste",(function(){e(this).trigger("keydown")}))}},init:function(){t.debug_mode&&console.log("[FLEXIFY CHECKOUT] Loaded params: ",t),this.localStorage.init(),this.Compatibility.init(),this.Triggers.init(),this.loginForm.init(),this.Steps.init(),this.Fields.init(),this.Payments.init(),this.Coupons.init(),this.Sidebar.init(),this.Components.init(),this.Conditions.init(),this.Session.init(),this.Validations.init(),this.processCheckout.init()}};e(document).ready((function(){o.init()}))}(jQuery);